<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Defines an age-structured SEIR model with non-pharmaceutical interventions (NPIs)
which influence social contact. Methods solve the set of
ordinary differential equations of the model with a chosen method of
numerical integration."><title>Defines an age-structured SEIR model with non-pharmaceutical interventions (NPIs)
which influence social contact. Methods solve the set of
ordinary differential equations of the model with a chosen method of
numerical integration. — SEIRDNPIAge-class • comomodels</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Defines an age-structured SEIR model with non-pharmaceutical interventions (NPIs)
which influence social contact. Methods solve the set of
ordinary differential equations of the model with a chosen method of
numerical integration. — SEIRDNPIAge-class"><meta property="og:description" content="Defines an age-structured SEIR model with non-pharmaceutical interventions (NPIs)
which influence social contact. Methods solve the set of
ordinary differential equations of the model with a chosen method of
numerical integration."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">comomodels</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/SEIRD_age_structured.html">Age-structured model</a>
    <a class="dropdown-item" href="../articles/SEIRDNPIAge.html">NPIs: age-structured model</a>
    <a class="dropdown-item" href="../articles/SEIRD.html">SEIRD model</a>
    <a class="dropdown-item" href="../articles/SEIRDV.html">Vaccinations model</a>
    <a class="dropdown-item" href="../articles/SEIRDVAge.html">Vaccinations: age-structured model</a>
    <a class="dropdown-item" href="../articles/SEIRD_rural_urban.html">Urban and rural metapopulations model</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Defines an age-structured SEIR model with non-pharmaceutical interventions (NPIs)
which influence social contact. Methods solve the set of
ordinary differential equations of the model with a chosen method of
numerical integration.</h1>
      
      <div class="d-none name"><code>SEIRDNPIAge-class.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Defines an age-structured SEIR model with non-pharmaceutical interventions (NPIs)
which influence social contact. Methods solve the set of
ordinary differential equations of the model with a chosen method of
numerical integration.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="co"># S4 method for SEIRDNPIAge</span>
<span class="fu"><a href="initial_conditions.html">initial_conditions</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>

<span class="co"># S4 method for SEIRDNPIAge</span>
<span class="fu"><a href="initial_conditions.html">initial_conditions</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span>

<span class="co"># S4 method for SEIRDNPIAge</span>
<span class="fu"><a href="transmission_parameters.html">transmission_parameters</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>

<span class="co"># S4 method for SEIRDNPIAge</span>
<span class="fu"><a href="transmission_parameters.html">transmission_parameters</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span>

<span class="co"># S4 method for SEIRDNPIAge</span>
<span class="fu"><a href="interventions.html">interventions</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>

<span class="co"># S4 method for SEIRDNPIAge</span>
<span class="fu"><a href="interventions.html">interventions</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span>

<span class="co"># S4 method for SEIRDNPIAge</span>
<span class="fu"><a href="run.html">run</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">times</span>, solve_method <span class="op">=</span> <span class="st">"lsoda"</span><span class="op">)</span>

<span class="co"># S4 method for SEIRDNPIAge</span>
<span class="fu"><a href="R0.html">R0</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>An object of the class SEIRDNPIAge.</p></dd>
<dt>value</dt>
<dd><p>(list) list of NPI parameters: starts, stops</p></dd>
<dt>times</dt>
<dd><p>(vector) time sequence over which to solve the model.
Must be of the form seq(t_start,t_end,by=t_step). Default time series
is seq(0, 100, by = 1).</p></dd>
<dt>solve_method</dt>
<dd><p>A string indicating the chosen numerical integration
method for solving the ode system. Default is <code>lsoda</code> which is also the
default for the ode function in the deSolve package used in this function.</p></dd>
<dt>model</dt>
<dd><p>an SEIRDNPIAge model</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Initial conditions of SEIRDNPIAge model.
Updated version of the age-structured SEIR model with NPIs
Transmission parameters of SEIRDNPIAge model.
Updated version of the age-structured SEIR model with NPIs.
object of class SEIRDNPIAge with NPI parameters assigned.
a data frame containing the time vector and time series of S, R, I and
D population fractions for each age group outputs with incidence numbers
for each age group.
an R0 value</p>
    </div>
    <div class="section level2">
    <h2 id="methods-by-generic-">Methods (by generic)<a class="anchor" aria-label="anchor" href="#methods-by-generic-"></a></h2>
    
<ul><li><p><code>initial_conditions</code>: Retrieves initial_conditions for an
age-structured SEIRD model.</p></li>
<li><p><code>initial_conditions&lt;-</code>: Sets initial_conditions of an age-structured
SEIRD model with NPIs.
If the initial conditions provided to do not sum to 1 or of different
sizes compared to the number of age groups, an error is thrown.</p></li>
<li><p><code>transmission_parameters</code>: Retrieves transmission_parameters for an
age-structured SEIR model with NPIs.</p></li>
<li><p><code>transmission_parameters&lt;-</code>: Sets the transmission_parameters for an
age-structured SEIRD model with NPIs.</p>
<p>Sets transmission_parameters of an
age-structured SEIR model.</p>
<p>If the transmission parameters provided to are not 1-dimensional an error is
thrown.</p></li>
<li><p><code>interventions</code>: Retrieves NPI parameters of SEIRDNPIAge model.</p></li>
<li><p><code>interventions&lt;-</code>: Setter method for NPI parameters of the SEIRDNPIAge model.</p></li>
<li><p><code>run</code>: Method to simulate output using from model.</p>
<p>Solves a system to ODEs which form an
age-structured simple SEIR model. The system of equations for the time
evolution of population fractions in Susceptible (S), Exposed (E), Infected
(I), Recovered (R) and Dead (D) groups in a given age group indexed by i is
given by</p>
<p>$$\frac{dS_i(t)}{dt} = -\beta(t) S_i \Sigma_{j}C_{ij}(t) I_j$$
$$\frac{dE_i(t)}{dt} = \beta(t) S_i \Sigma_{j}C{ij}(t) I_j-\kappa E_i$$
$$\frac{dI_i(t)}{dt} = \kappa E_i - (\gamma_i + \mu_i) I_i$$
$$\frac{dR_i(t)}{dt} = \frac{\text{d}R_i}{\text{d}t} = \gamma_i I_i$$
$$\frac{dC(t)}{dt} = \beta_i(t) S_i \Sigma_{j}C_{ij}(t) I_j$$
$$\frac{dD_i(t)}{dt} = \mu_i I_i(t)$$</p>
<p>where C is a contact matrix whose elements represents the
contact between different age groups (rows) with age groups of
people they come in contact with (columns). Inter(t) is the value at time t
of the NPI protocol defined by the NPI (intervention) parameters.
The model encorperates the influence of NPIs
which act to reduce the degree of social contact and/or change the transmission
parameters beta between individuals. This is
done by splitting any simulation of the model into several intervals and utilising
a different contact matrix in each interval to simulate the introduction of NPIs through
time. This function relies on the package deSolve to numerically integrate
the set of equations above.</p></li>
<li><p><code>R0</code>: Calculates the basic reproduction number for SEIRDNPIAge model</p>
<p>To calculate this parameter, we first calculate the next generation matrix
G, where G_ij gives the expected number of secondary infections of type i
caused by a single infectious individual of type j, assuming that all
of type i are susceptible. In the SEIRDNPIAge model, the number of contacts
resulting in infection per unit time in age group i is beta N_i C_ij, where
N_i corresponds to the proportion of the population in that age group, beta is the
non-intervention transmission parameter and C_ij is the non-intervention contact
matrix element. The average duration of infection is
1 / (mu_j + gamma_j) for an individual in age group j. This means the average number of
secondary infections of type i caused by an infectious individual of type j is
g_ij = beta N_i C_ij / (mu_i + gamma_i). R0 is then given by the dominant
eigenvalue of the G matrix.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="slots">Slots<a class="anchor" aria-label="anchor" href="#slots"></a></h2>
    

<dl><dt><code>output_names</code></dt>
<dd><p>names of the compartments which are used by the
model.</p></dd>


<dt><code>initial_condition_names</code></dt>
<dd><p>names of the initial conditions used by the
model.</p></dd>


<dt><code>transmission_parameter_names</code></dt>
<dd><p>names of the transmission parameters used
by the model.</p></dd>


<dt><code>npi_parameter_names</code></dt>
<dd><p>list of names of NPI parameters
(characters). Default is list ("starts", "stops").</p></dd>


<dt><code>initial_conditions</code></dt>
<dd><p>named list containing the initial conditions of the
model. Initial values for each compartment, S0, E0, I0, R0.</p></dd>


<dt><code>transmission_parameters</code></dt>
<dd><p>named list containing the transmission
parameters of the model. Transmission parameters b, k, g represent the
rates of changes between the compartments.</p></dd>


<dt><code>npi_parameters</code></dt>
<dd><p>list of values for NPI parameters
(double).</p></dd>


<dt><code>interventions</code></dt>
<dd><p>list of NPI periods</p></dd>


<dt><code>contact_matrix</code></dt>
<dd><p>A square matrices, each with dimension
equal to n_age_categories x n_age_categories. This matrix represents the
contact between different age groups (rows) with age groups of
people they come in contact with (columns) in the ist interval of the
simulation (normally with no restriction on social contact.</p></dd>


<dt><code>contact_matrix_npi</code></dt>
<dd><p>A list of square matrices, each with dimension
equal to n_age_categories x n_age_categories. This matrix represents the
contact between different age groups (rows) with age groups of
people they come in contact with (columns) in the ist interval of the
simulation (normally with no restriction on social contact.</p></dd>


<dt><code>n_age_categories</code></dt>
<dd><p>number of age categories.</p></dd>


<dt><code>n_npi</code></dt>
<dd><p>number of NPI periods.</p></dd>


<dt><code>age_ranges</code></dt>
<dd><p>list of string characters representing the range of ages of
people in each age category. This object must have length
<code>n_age_categories</code> (otherwise an error is returned) and each element
must be formatted as 'age1-age2'.</p></dd>


</dl></div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Sumali Bajaj, Fergus Cooper.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer></div>

  

  

  </body></html>

