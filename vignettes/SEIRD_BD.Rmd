---
title: "SEIRD_BD: including births and natural deaths and waning immunity"
output: rmarkdown::html_vignette
bibliography: references.bib
vignette: >
  %\VignetteIndexEntry{SEIRD_BD}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
options(scipen=999)
```

```{r setup, include=FALSE}
library(comomodels)
library(tidyverse)
```

## Introduction
Over longer timescales, births and natural deaths can affect the ability of an infectious disease to invade a population. If there is no maternal immunity inherited by newborns, we may assume they are susceptible to infection. This replenishment of the susceptible population can, over long periods, allow an infectious disease to re-invade a population, and an epidemic wave may reoccur.

In the basic SEIRD model, an individual who has been exposed to a pathogen and "recovered" from infection is assumed to be immune to reinfection. Immunity to reinfection is known to wane in the time period following when individuals receive vaccinations [@goldberg2021waning]. Natural immunity resultant from previous infection with SARS-CoV-2 has been found to have a stronger and longer-lasting protection against the Delta version of the virus than the Pfizer BNT162b2 two-dose vaccine [@gazit2021comparing], although it is widely thought that the protection conferred by infection also wanes over time.

Waning immunity has a similar impact on transmission dynamics as does including births in that it leads to replenishment of susceptible individuals. Though the rate at which it does so is different -- for COVID-19, it is much faster.

In this notebook, we investigate how the dynamics of infection throughout the population are affected by births and natural deaths and a waning natural immunity.

## Births and natural death
To begin, we ignore waning natural immunity and etend the basic SEIRD model to include births and natural death terms.

$$\frac{\text{d}S}{\text{d}t} = \lambda -\beta S I - \nu S,$$
$$\frac{\text{d}E}{\text{d}t} = \beta S I - (\kappa + \nu) E,$$
$$\frac{\text{d}I}{\text{d}t} = \kappa E - (\gamma + \mu + \nu) I,$$
$$\frac{\text{d}R}{\text{d}t} = \gamma I - \nu R,$$
$$\frac{\text{d}D}{\text{d}t} = \mu I + \nu (S + E + I + R).$$

Here, $\lambda\geq 0$ represents the rate of birth into the population. The effect of this term is to increase the population size over time. $\nu > 0$ represents the rate of death due to causes unrelated to COVID-19.

The system is closed by specifying the initial conditions
$$S(0) = S_0,\ E(0) = E_0,\ I(0) = I_0,\ R(0) = r_0,\ D(0) = 0.$$

Note, we have used $r_0$ here to avoid ambiguity with the basic reproduction number.

If we ignore death due to COVID-19 infection (i.e. set $\mu=0$), the evolution of the population size, $N(t)=S(t)+E(t)+I(t)+R(t)$ is given by:

\begin{equation}
\frac{\text{d}N}{\text{d}t} = \lambda - \nu N.
\end{equation}

which has a steady state: $N^* = \lambda / \nu$. Assuming the initial population size, $N(0)$, is below this, it grows at an ever-declining rate towards this steady state:

\begin{equation}
N(t) = N^* - (N^* - N(0)) \exp(-\nu t).
\end{equation}

### Basic reproduction number
The basic reproduction number, $R_0$, is obtained in similar fashion to that of the basic SEIRD model. A slight difference here is that exposed individuals can die before they pass on infection. So, $R_0$ for the SEIRD_BD model is given by:

\begin{align}
\begin{split}
R_0 = &\text{ # infected per unit time by an infectious indiv. } \times\\
&\text{ prob. of surviving latency period } \times\\
&\text{ av. duration of infectiousness},
\end{split}
\end{align}

where we have assumed the entire population are susceptible, in line with the definition of the basic reproduction number [@diekmann1990definition]. This results in an expression:

\begin{equation}
R_0 = \beta \times \frac{\kappa}{\kappa + \nu} \times \frac{1}{\gamma + \mu + \nu}.
\end{equation}

Where we note that, if $\nu=0$, the basic reproduction reduces to that for the basic SEIRD model: $R_0 = \beta / (\gamma + \mu)$. Indeed, for COVID-19 transmission, the rate of natural death is much lower than the rate of becoming infectious or the COVID-19-induced death rate, so the reproduction numbers of the basic SEIRD model and that above will be virtually indistinguishable.

### Multiple epidemic waves and an endemic steady state
Let's create an SEIRD_BD model.
```{r}
model <- SEIRD_BD()
```

And we are going to start with 0.01\% infectious individuals and everyone else is susceptible.
```{r}
initial_conditions(model) <- list(S0=0.999, E0=0, I0=0.001, R0=0)
```

We next give it transmission parameters. Here, we follow suit with the same parameter values as for the basic SEIRD model for $\mu$, $\kappa$ and $\gamma$. We start by allowing no natural death, by setting $\nu=0$. To illustrate an implication of replenishment of susceptibles, we include an unnaturally high birth rate where newborns account for 0.1\% of the population each day at beginning of simulations. Finally, we set $\beta$ so that $R_0=2.4$ as in report 9 by Imperial College [@ferguson2020report].

