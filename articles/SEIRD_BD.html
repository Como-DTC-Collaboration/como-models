<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="comomodels">
<title>Births and natural deaths and waning natural immunity • comomodels</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Births and natural deaths and waning natural immunity">
<meta property="og:description" content="comomodels">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">comomodels</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/SEIRD_age_structured.html">Age-structured model</a>
    <a class="dropdown-item" href="../articles/SEIaImIsRD.html">Asymptomatic, mild and severe symptom compartment model</a>
    <a class="dropdown-item" href="../articles/SEIRD_BD.html">Births and natural deaths and waning natural immunity</a>
    <a class="dropdown-item" href="../articles/SEIRDNPIAge.html">NPIs: age-structured model</a>
    <a class="dropdown-item" href="../articles/SEIRD_CT.html">NPIs: contact tracing and quarantining</a>
    <a class="dropdown-item" href="../articles/SEIRD.html">SEIRD model</a>
    <a class="dropdown-item" href="../articles/SEIRDV.html">Vaccinations model</a>
    <a class="dropdown-item" href="../articles/SEIRDVAge.html">Vaccinations: age-structured model</a>
    <a class="dropdown-item" href="../articles/SEIRD_rural_urban.html">Urban and rural metapopulations model</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">
<script src="SEIRD_BD_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Births and natural deaths and waning natural immunity</h1>
                        <h4 data-toc-skip class="author">Idil Cazimoglu and Ben Lambert</h4>
            
      
      
      <div class="d-none name"><code>SEIRD_BD.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>As the SARS-CoV-2 virus becomes endemic, focus shifts from short-term control of the current epidemic wave to learning to live with the virus long-term. Over longer timescales, births and natural deaths can affect the ability of an infectious disease to invade a population. If there is no maternal immunity inherited by newborns, we may assume they are susceptible to infection. This replenishment of the susceptible population can, over long periods, allow an infectious disease to re-invade a population, and an epidemic wave may reoccur.</p>
<p>In the basic SEIRD model, an individual who has been exposed to a pathogen and “recovered” from infection is assumed to be immune to reinfection. Immunity to reinfection is known to wane in the time period following when individuals receive vaccinations <span class="citation">(Goldberg et al. 2021)</span>. Natural immunity resultant from previous infection with SARS-CoV-2 has been found to have a stronger and longer-lasting protection against the Delta version of the virus than the Pfizer BNT162b2 two-dose vaccine <span class="citation">(Gazit et al. 2021)</span>, although it is widely thought that the protection conferred by infection also wanes over time.</p>
<p>Waning immunity and births have a similar impact on transmission dynamics as both processes lead to replenishment of susceptible individuals. Though the rate at which they do so is different – for COVID-19, waning immunity has a much stronger effect than births.</p>
<p>In this notebook, we investigate first how the dynamics of infection throughout the population are affected by births and natural deaths. We then extend the model further with waning natural immunity.</p>
</div>
<div class="section level2">
<h2 id="births-and-natural-death">Births and natural death<a class="anchor" aria-label="anchor" href="#births-and-natural-death"></a>
</h2>
<p>To begin, we ignore waning natural immunity and extend the basic SEIRD model to include births and natural death terms.</p>
<p><span class="math display">\[\frac{\text{d}S}{\text{d}t} = \lambda -\beta S I - \nu S,\]</span> <span class="math display">\[\frac{\text{d}E}{\text{d}t} = \beta S I - (\kappa + \nu) E,\]</span> <span class="math display">\[\frac{\text{d}I}{\text{d}t} = \kappa E - (\gamma + \mu + \nu) I,\]</span> <span class="math display">\[\frac{\text{d}R}{\text{d}t} = \gamma I - \nu R,\]</span> <span class="math display">\[\frac{\text{d}D}{\text{d}t} = \mu I + \nu (S + E + I + R).\]</span></p>
<p>Here, <span class="math inline">\(\lambda\geq 0\)</span> represents the rate of birth into the population. The effect of this term is to increase the population size over time. <span class="math inline">\(\nu &gt; 0\)</span> represents the rate of death due to causes unrelated to COVID-19.</p>
<p>The system is closed by specifying the initial conditions <span class="math display">\[S(0) = S_0,\ E(0) = E_0,\ I(0) = I_0,\ R(0) = r_0,\ D(0) = 0.\]</span></p>
<p>Note, we have used <span class="math inline">\(r_0\)</span> here to avoid ambiguity with the basic reproduction number.</p>
<p>If we ignore death due to COVID-19 infection (i.e. set <span class="math inline">\(\mu=0\)</span>), the evolution of the population size, <span class="math inline">\(N(t)=S(t)+E(t)+I(t)+R(t)\)</span> is given by:</p>
<p><span class="math display">\[\begin{equation}
\frac{\text{d}N}{\text{d}t} = \lambda - \nu N.
\end{equation}\]</span></p>
<p>which has a steady state: <span class="math inline">\(N^* = \lambda / \nu\)</span>. Assuming the initial population size, <span class="math inline">\(N(0)\)</span>, is below this, it grows at an ever-declining rate towards this steady state:</p>
<p><span class="math display">\[\begin{equation}
N(t) = N^* - (N^* - N(0)) \exp(-\nu t).
\end{equation}\]</span></p>
<div class="section level3">
<h3 id="basic-reproduction-number">Basic reproduction number<a class="anchor" aria-label="anchor" href="#basic-reproduction-number"></a>
</h3>
<p>In order to set COVID-19-relevant parameter ranges for this model, we use the basic reproduction number <span class="math inline">\(R_0\)</span>, which can be derived in similar fashion to that for the basic SEIRD model. A slight difference here is that exposed individuals can die before they pass on infection. So, <span class="math inline">\(R_0\)</span> for the SEIRD_BD model is given by:</p>
<p><span class="math display">\[\begin{align}
\begin{split}
R_0 = &amp;\text{ # infected per unit time by an infectious indiv. } \times\\
&amp;\text{ prob. of surviving latent period } \times\\
&amp;\text{ av. duration of infectiousness},
\end{split}
\end{align}\]</span></p>
<p>where we have assumed the entire population are susceptible, in line with the definition of the basic reproduction number <span class="citation">(Diekmann, Heesterbeek, and Metz 1990)</span>. This results in an expression:</p>
<p><span class="math display">\[\begin{equation}
R_0 = \beta \times \frac{\kappa}{\kappa + \nu} \times \frac{1}{\gamma + \mu + \nu},
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\kappa/(\kappa+\nu)\)</span> is the probability of surviving the latent period and, since infectious individuals may recover (at rate <span class="math inline">\(\gamma\)</span>), die due to COVID-19 infection (at rate <span class="math inline">\(\mu\)</span>), or due to non-COVID-19 causes (at rate <span class="math inline">\(\nu\)</span>), the average duration spent in this compartment is <span class="math inline">\(1/(\gamma + \mu + \nu)\)</span>.</p>
<p>Where we note that, if <span class="math inline">\(\nu=0\)</span>, the basic reproduction reduces to that for the basic SEIRD model: <span class="math inline">\(R_0 = \beta / (\gamma + \mu)\)</span>. Indeed, for COVID-19 transmission, the rate of natural death is much lower than the rate of becoming infectious or the COVID-19-induced death rate, so the reproduction numbers of the basic SEIRD model and that above will be virtually indistinguishable.</p>
</div>
<div class="section level3">
<h3 id="multiple-epidemic-waves-and-an-endemic-steady-state">Multiple epidemic waves and an endemic steady state<a class="anchor" aria-label="anchor" href="#multiple-epidemic-waves-and-an-endemic-steady-state"></a>
</h3>
<p>Let’s create an SEIRD_BD model.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SEIRD_BD-class.html">SEIRD_BD</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>And we are going to start with 0.1% infectious individuals and everyone else is susceptible.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/initial_conditions.html">initial_conditions</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>S0<span class="op">=</span><span class="fl">0.999</span>, E0<span class="op">=</span><span class="fl">0</span>, I0<span class="op">=</span><span class="fl">0.001</span>, R0<span class="op">=</span><span class="fl">0</span><span class="op">)</span></code></pre></div>
<p>We next give it transmission parameters. Here, we follow suit with the same parameter values as in <code>Vignette("SEIRD")</code> for <span class="math inline">\(\mu\)</span>, <span class="math inline">\(\kappa\)</span> and <span class="math inline">\(\gamma\)</span>. We start by allowing no natural death, by setting <span class="math inline">\(\nu=0\)</span>. To illustrate an implication of replenishment of susceptibles, we include an unnaturally high birth rate where newborns account for 0.1% of the population each day at beginning of simulations. Finally, we set <span class="math inline">\(\beta\)</span> so that <span class="math inline">\(R_0=2.4\)</span> as in report 9 by Imperial College <span class="citation">(Ferguson et al. 2020)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">kappa</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">5.5</span>
<span class="va">zeta</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">2</span>
<span class="va">ifr</span> <span class="op">&lt;-</span> <span class="fl">0.0066</span>
<span class="va">gamma</span> <span class="op">&lt;-</span> <span class="va">zeta</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">ifr</span><span class="op">)</span>
<span class="va">mu</span> <span class="op">&lt;-</span> <span class="va">zeta</span> <span class="op">*</span> <span class="va">ifr</span>
<span class="va">nu</span> <span class="op">&lt;-</span> <span class="fl">0</span>
<span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fl">0.001</span>
<span class="va">delta</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co"># waning natural immunity term -- to explore later</span>
<span class="va">R0_target</span> <span class="op">&lt;-</span> <span class="fl">2.4</span>
<span class="va">beta</span> <span class="op">&lt;-</span> <span class="va">R0_target</span> <span class="op">*</span> <span class="op">(</span><span class="va">kappa</span> <span class="op">+</span> <span class="va">nu</span><span class="op">)</span> <span class="op">/</span> <span class="va">kappa</span> <span class="op">*</span> <span class="op">(</span><span class="va">gamma</span> <span class="op">+</span> <span class="va">mu</span> <span class="op">+</span> <span class="va">nu</span><span class="op">)</span>

<span class="fu"><a href="../reference/transmission_parameters.html">transmission_parameters</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
  beta<span class="op">=</span><span class="va">beta</span>,
  kappa<span class="op">=</span><span class="va">kappa</span>,
  gamma<span class="op">=</span><span class="va">gamma</span>,
  mu<span class="op">=</span><span class="va">mu</span>,
  lambda<span class="op">=</span><span class="va">lambda</span>,
  nu<span class="op">=</span><span class="va">nu</span>,
  delta<span class="op">=</span><span class="va">delta</span><span class="op">)</span></code></pre></div>
<p>We now run the model using these parameters and plot the infectious proportion over time. This plot illustrates repeated epidemic waves, each representing a re-invasion of the pathogen through the population.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># run model</span>
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span><span class="va">model</span>, times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5000</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>

<span class="co"># extract states</span>
<span class="va">states</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">$</span><span class="va">states</span>

<span class="co"># plot infectious</span>
<span class="va">states</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">compartment</span> <span class="op">==</span> <span class="st">"I"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span> <span class="op">/</span> <span class="fl">365.25</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">compartment</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"time (years)"</span>, y <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="SEIRD_BD_files/figure-html/unnamed-chunk-5-1.png" width="960"></p>
<p>To see how this oscillatory behaviour occurs, we overlay the time-varying reproduction number, <span class="math inline">\(R_t = R_0 S(t)\)</span>, on the same plot.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># calculate R_0</span>
<span class="va">R_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/R0.html">R0</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>

<span class="co"># plot: magnifying the infectious numbers so they are visible</span>
<span class="va">states</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>value<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">compartment</span><span class="op">==</span><span class="st">"S"</span>, <span class="va">R_0</span> <span class="op">*</span> <span class="va">value</span>, <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>compartment<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">compartment</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>compartment<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">compartment</span><span class="op">==</span><span class="st">"S"</span>, <span class="st">"Rt"</span>, <span class="va">compartment</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">compartment</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>value<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">compartment</span><span class="op">==</span><span class="st">"I"</span>, <span class="va">value</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>, <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">compartment</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rt"</span>, <span class="st">"I"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span> <span class="op">/</span> <span class="fl">365.25</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">1</span>, linetype<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">compartment</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"time (years)"</span>, y <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="SEIRD_BD_files/figure-html/unnamed-chunk-6-1.png" width="960"></p>
<p>This shows the new susceptibles born into the population lead <span class="math inline">\(R_t\)</span> to increase over time, until, eventually, <span class="math inline">\(R_t&gt;1\)</span>, and a new epidemic wave sweeps through the population. Over time, these waves occur more frequently and they become less marked.</p>
<p>Eventually <span class="math inline">\(R_t\rightarrow 1\)</span>, and an endemic equilibrium is reached, where a non-zero fraction of the population are infected. This is a notable difference from the SEIRD model, which does not permit an endemic steady state.</p>
</div>
<div class="section level3">
<h3 id="steady-states">Steady states<a class="anchor" aria-label="anchor" href="#steady-states"></a>
</h3>
<p>To further explore the steady states of this system, we set the right-hand sides of the ordinary differential equations within the system to zero:</p>
<p><span class="math display">\[\lambda -\beta S I - \nu S=0\]</span> <span class="math display">\[\beta S I - (\kappa + \nu) E=0\]</span> <span class="math display">\[\kappa E - (\gamma + \mu + \nu) I=0\]</span> <span class="math display">\[\gamma I + \nu R=0.\]</span> Solving these simultaneously yields two possible equilibria: one representing the disease-free steady state; another representing the case when the disease becomes endemic. The endemic steady states are given by:</p>
<p><span class="math display">\[\begin{align}
S^* &amp;= \frac{(\kappa +\nu ) (\gamma +\mu +\nu )}{\beta  \kappa },\\
E^* &amp;= \frac{\lambda }{\kappa +\nu }-\frac{\nu  (\gamma +\mu +\nu )}{\beta  \kappa },\\
I^* &amp;= \frac{\kappa  \lambda }{(\kappa +\nu ) (\gamma +\mu +\nu )}-\frac{\nu }{\beta },\\
R^* &amp;= \frac{\gamma  \kappa  \lambda }{\nu  (\kappa +\nu ) (\gamma +\mu +\nu )}-\frac{\gamma
   }{\beta }.
\end{align}\]</span></p>
<p>For <span class="math inline">\(I^*&gt;0\)</span>, we find the following condition:</p>
<p><span class="math display">\[\begin{equation}
\beta &gt;\frac{\nu  (\kappa +\nu ) (\gamma +\mu +\nu )}{\kappa  \lambda }.
\end{equation}\]</span></p>
<p>For the previously simulated system, we calculate <span class="math inline">\(I^*\)</span> and overlay this on the plot to illustrate the limiting behaviour of the system.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">I_star</span> <span class="op">=</span> <span class="va">kappa</span> <span class="op">*</span> <span class="va">lambda</span> <span class="op">/</span> <span class="op">(</span><span class="op">(</span><span class="va">kappa</span> <span class="op">+</span> <span class="va">nu</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">gamma</span> <span class="op">+</span> <span class="va">kappa</span> <span class="op">+</span> <span class="va">nu</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="va">nu</span> <span class="op">/</span> <span class="va">beta</span>

<span class="va">states</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">compartment</span> <span class="op">==</span> <span class="st">"I"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span> <span class="op">/</span> <span class="fl">365.25</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">I_star</span>, linetype<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">compartment</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"time (years)"</span>, y <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="SEIRD_BD_files/figure-html/unnamed-chunk-7-1.png" width="960"></p>
</div>
<div class="section level3">
<h3 id="more-realistic-parameter-values-for-covid-19">More realistic parameter values for COVID-19<a class="anchor" aria-label="anchor" href="#more-realistic-parameter-values-for-covid-19"></a>
</h3>
<p>The parameter values for <span class="math inline">\(\nu\)</span> and <span class="math inline">\(\lambda\)</span> considered thus far have been unrealistic. We now set these to more reasonable values for the UK. The average life expectancy of a female in the UK is 82.9 years for females and 79.0 years for males <span class="citation">(ONS, n.d.)</span>: assuming equal numbers of each sex, the average life expectancy is 80.95 years. To determine <span class="math inline">\(\nu\)</span>, we calculate a per day mortality rate: <span class="math inline">\(\nu=1/(80.95 \times 365.25)=3.4\times 10^{-5}\)</span> per day. In 2019, the UK experienced 712,680 births in a population of 66.8 million <span class="citation">(ONS, n.d.)</span>. As a fraction, annual births then represent roughly 1% of the population. To determine <span class="math inline">\(\lambda\)</span>, we convert this to a daily rate resulting in <span class="math inline">\(\lambda=2.9 \times 10^{-5}\)</span>. We then use these parameter values to simulate the model.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># set parameter values</span>
<span class="va">nu</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">80.95</span> <span class="op">*</span> <span class="fl">365.25</span><span class="op">)</span>
<span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fl">712680</span> <span class="op">/</span> <span class="fl">66.8e6</span> <span class="op">/</span> <span class="fl">365.25</span>

<span class="va">beta</span> <span class="op">&lt;-</span> <span class="va">R0_target</span> <span class="op">*</span> <span class="op">(</span><span class="va">kappa</span> <span class="op">+</span> <span class="va">nu</span><span class="op">)</span> <span class="op">/</span> <span class="va">kappa</span> <span class="op">*</span> <span class="op">(</span><span class="va">gamma</span> <span class="op">+</span> <span class="va">mu</span> <span class="op">+</span> <span class="va">nu</span><span class="op">)</span>

<span class="fu"><a href="../reference/transmission_parameters.html">transmission_parameters</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
  beta<span class="op">=</span><span class="va">beta</span>,
  kappa<span class="op">=</span><span class="va">kappa</span>,
  gamma<span class="op">=</span><span class="va">gamma</span>,
  mu<span class="op">=</span><span class="va">mu</span>,
  lambda<span class="op">=</span><span class="va">lambda</span>,
  nu<span class="op">=</span><span class="va">nu</span>,
  delta<span class="op">=</span><span class="va">delta</span><span class="op">)</span>

<span class="co"># run model</span>
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span><span class="va">model</span>, times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span> <span class="op">*</span> <span class="fl">365.25</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>

<span class="co"># extract states</span>
<span class="va">states</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">$</span><span class="va">states</span>

<span class="co"># plot infectious</span>
<span class="va">states</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">compartment</span> <span class="op">==</span> <span class="st">"I"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span> <span class="op">/</span> <span class="fl">365.25</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">compartment</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"time (years)"</span>, y <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="SEIRD_BD_files/figure-html/unnamed-chunk-8-1.png" width="960"> From this, we see that there is a second epidemic wave, but it takes nearly 100 years for it to occur! So, birth and natural death (in the UK, at least) appear not to play substantial roles in causing epidemic re-emergence.</p>
</div>
</div>
<div class="section level2">
<h2 id="waning-natural-immunity">Waning natural immunity<a class="anchor" aria-label="anchor" href="#waning-natural-immunity"></a>
</h2>
<p>We now explore how the dynamics are affected by the introduction of waning natural immunity. Vaccine efficacy is known to wane after a number of months for the vaccines developed thus far: for example, considering the BNT162b2 (Pfizer) vaccine, the rates of infection for those vaccinated six months ago are similar to those in vaccine-naive individuals <span class="citation">(Goldberg et al. 2021)</span>. It appears that infection confers a protection against reinfection which remains strong up to around several months to a year post-infection <span class="citation">(Leidi et al. 2021; Abu-Raddad et al. 2021; Gallais et al. 2021)</span>, but is also thought to eventually wane.</p>
<p>Here, to account for waning in natural immunity over time, we modify the <span class="math inline">\(S\)</span> and <span class="math inline">\(R\)</span> compartments to allow recovered individuals to become susceptible again:</p>
<p><span class="math display">\[\frac{\text{d}S}{\text{d}t} = \lambda + \delta R -\beta S I - \nu S,\]</span> <span class="math display">\[\frac{\text{d}R}{\text{d}t} = \gamma I - (\nu + \delta) R,\]</span> where <span class="math inline">\(\delta\geq 0\)</span> is the rate at which recovered individuals become once again susceptible.</p>
<p>Note, this model does not allow primary infection to affect the risk of severe disease, and thus disease-related death, upon reinfection, which may be unrealistic for COVID-19, where this risk may be lowered. But including this effect would not likely substantially affect dynamics of infections, which is our focus here.</p>
<p>To illustrate the impact of waning immunity to natural infection, we assume that the average duration of immunity to reinfection is 1.5 years. We then run simulations using the same parameters as above.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1.5</span> <span class="op">*</span> <span class="fl">365.25</span><span class="op">)</span>

<span class="fu"><a href="../reference/transmission_parameters.html">transmission_parameters</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
  beta<span class="op">=</span><span class="va">beta</span>,
  kappa<span class="op">=</span><span class="va">kappa</span>,
  gamma<span class="op">=</span><span class="va">gamma</span>,
  mu<span class="op">=</span><span class="va">mu</span>,
  lambda<span class="op">=</span><span class="va">lambda</span>,
  nu<span class="op">=</span><span class="va">nu</span>,
  delta<span class="op">=</span><span class="va">delta</span><span class="op">)</span>

<span class="co"># run model</span>
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span><span class="va">model</span>, times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span> <span class="op">*</span> <span class="fl">365.25</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>

<span class="co"># extract states</span>
<span class="va">states</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">$</span><span class="va">states</span>

<span class="co"># plot infectious</span>
<span class="va">states</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">compartment</span> <span class="op">==</span> <span class="st">"I"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span> <span class="op">/</span> <span class="fl">365.25</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">compartment</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"time (years)"</span>, y <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="SEIRD_BD_files/figure-html/unnamed-chunk-9-1.png" width="960"></p>
<p>This model illustrates reoccuring epidemic waves. Since the rate at which natural immunity to reinfection wanes is much faster the rate at which susceptibles are replenished due to birth, this leads to much more frequent epidemic waves.</p>
<p>This model, as for the model above with births and deaths but no waning immunity, also allows an endemic steady state:</p>
<p><span class="math display">\[S^* = \frac{(\kappa +\nu ) (\gamma +\mu +\nu )}{\beta  \kappa },\]</span></p>
<p><span class="math display">\[E^* = \frac{(\nu +\delta ) (\gamma +\mu +\nu ) (\beta 
   \kappa  \lambda - \nu  (\kappa +\nu ) (\gamma +\mu +\nu ))}{\beta  \kappa  (\gamma  \nu  (\kappa +\nu +\delta )+(\kappa +\nu )
   (\mu +\nu ) (\nu +\delta ))},\]</span></p>
<p><span class="math display">\[ I^* = \frac{(\nu +\delta ) (\beta  \kappa  \lambda -\nu  (\kappa +\nu ) (\gamma +\mu +\nu
   ))}{\beta  (\gamma  \nu  (\kappa +\nu +\delta )+(\kappa +\nu ) (\mu +\nu ) (\nu
   +\delta ))},\]</span></p>
<p><span class="math display">\[ R^* = \frac{\beta  \gamma  \kappa  \lambda -\gamma  \nu  (\kappa +\nu ) (\gamma +\mu +\nu
   )}{\beta  (\gamma  \nu  (\kappa +\nu +\delta )+(\kappa +\nu ) (\mu +\nu ) (\nu +\delta
   ))}.\]</span></p>
<p>We now overlay <span class="math inline">\(I^*\)</span> on the plot above, running the model for longer to illustrate the approach to equilibrium.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">I_star</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">beta</span> <span class="op">*</span> <span class="va">kappa</span> <span class="op">*</span> <span class="va">lambda</span> <span class="op">-</span> <span class="va">nu</span> <span class="op">*</span> <span class="op">(</span><span class="va">kappa</span> <span class="op">+</span> <span class="va">nu</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">gamma</span> <span class="op">+</span> <span class="va">mu</span> <span class="op">+</span> <span class="va">nu</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">nu</span> <span class="op">+</span> <span class="va">delta</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">beta</span> <span class="op">*</span> <span class="op">(</span><span class="va">kappa</span> <span class="op">+</span> <span class="va">nu</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">mu</span> <span class="op">+</span> <span class="va">nu</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">nu</span> <span class="op">+</span> <span class="va">delta</span><span class="op">)</span> <span class="op">+</span> <span class="va">gamma</span> <span class="op">*</span> <span class="va">nu</span> <span class="op">*</span> <span class="op">(</span><span class="va">kappa</span> <span class="op">+</span> <span class="va">nu</span> <span class="op">+</span> <span class="va">delta</span><span class="op">)</span><span class="op">)</span>

<span class="co"># run model</span>
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span><span class="va">model</span>, times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span> <span class="op">*</span> <span class="fl">365.25</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>

<span class="co"># extract states</span>
<span class="va">states</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">$</span><span class="va">states</span>

<span class="co"># plot infectious</span>
<span class="va">states</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">compartment</span> <span class="op">==</span> <span class="st">"I"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span> <span class="op">/</span> <span class="fl">365.25</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">I_star</span>, linetype<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">compartment</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"time (years)"</span>, y <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="SEIRD_BD_files/figure-html/unnamed-chunk-10-1.png" width="960"></p>
<p>With this model, we can determine the number of daily cases expected to arise at the endemic equilibrium:</p>
<p><span class="math display">\[\begin{equation}
\frac{\text{d}C}{\text{d}t} = \beta S^* I^*,
\end{equation}\]</span></p>
<p>where <span class="math inline">\(C\)</span> represents cumulative case counts and <span class="math inline">\(S^*\)</span> and <span class="math inline">\(I^*\)</span> are constants. This implies new cases appearing each day given by:</p>
<p><span class="math display">\[\begin{equation}
C(t+1) - C(t) = \beta S^* I^*.
\end{equation}\]</span></p>
<p>For the parameters of the model, this implies roughly 46000 daily cases for the UK once we reach equilibrium – a huge number. We now determine the sensitivity of this case count to assumptions about the duration of waning immunity. To do so, we consider average durations of immunity to reinfection ranging from 4 months to 3 years. In each case, we calculate the number of daily cases at the endemic equilibrium.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># helper function</span>
<span class="va">daily_cases</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">delta</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">S_star</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">kappa</span> <span class="op">+</span> <span class="va">nu</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">gamma</span> <span class="op">+</span> <span class="va">mu</span> <span class="op">+</span> <span class="va">nu</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">beta</span> <span class="op">*</span> <span class="va">kappa</span><span class="op">)</span>
<span class="va">cases</span> <span class="op">&lt;-</span> <span class="va">beta</span> <span class="op">*</span> <span class="va">I_star</span> <span class="op">*</span> <span class="va">S_star</span>
  <span class="va">I_star</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">beta</span> <span class="op">*</span> <span class="va">kappa</span> <span class="op">*</span> <span class="va">lambda</span> <span class="op">-</span> <span class="va">nu</span> <span class="op">*</span> <span class="op">(</span><span class="va">kappa</span> <span class="op">+</span> <span class="va">nu</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">gamma</span> <span class="op">+</span> <span class="va">mu</span> <span class="op">+</span> <span class="va">nu</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">nu</span> <span class="op">+</span> <span class="va">delta</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">beta</span> <span class="op">*</span> <span class="op">(</span><span class="va">kappa</span> <span class="op">+</span> <span class="va">nu</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">mu</span> <span class="op">+</span> <span class="va">nu</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">nu</span> <span class="op">+</span> <span class="va">delta</span><span class="op">)</span> <span class="op">+</span> <span class="va">gamma</span> <span class="op">*</span> <span class="va">nu</span> <span class="op">*</span> <span class="op">(</span><span class="va">kappa</span> <span class="op">+</span> <span class="va">nu</span> <span class="op">+</span> <span class="va">delta</span><span class="op">)</span><span class="op">)</span>
  <span class="va">beta</span> <span class="op">*</span> <span class="va">S_star</span> <span class="op">*</span> <span class="va">I_star</span> <span class="op">*</span> <span class="fl">66.8e6</span>
<span class="op">}</span>

<span class="co"># sensitivity analysis</span>
<span class="va">immunity_durations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span>, <span class="fl">3</span>, length.out<span class="op">=</span><span class="fl">50</span><span class="op">)</span>
<span class="va">deltas</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">365.25</span> <span class="op">*</span> <span class="va">immunity_durations</span><span class="op">)</span>
<span class="va">cases</span> <span class="op">&lt;-</span> <span class="fu">daily_cases</span><span class="op">(</span><span class="va">deltas</span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="va">immunity_durations</span>, <span class="va">cases</span><span class="op">)</span>
<span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">immunity_durations</span>, y<span class="op">=</span><span class="va">cases</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Average natural immunity to reinfection (years)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Daily endemic case counts"</span><span class="op">)</span></code></pre></div>
<p><img src="SEIRD_BD_files/figure-html/unnamed-chunk-12-1.png" width="960"></p>
<p>Over the range of durations surveyed, the minimum case counts was 28000 and maximum was 99000.</p>
<p>Whilst this model makes a number of simplifications, these simulations hint that interventions such as ongoing booster vaccination campaigns may be required to keep cases at a reasonable level.</p>
</div>
<div class="section level2 unnumbered">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references">
<div id="ref-abu2021sars">
<p>Abu-Raddad, Laith J, Hiam Chemaitelly, Peter Coyle, Joel A Malek, Ayeda A Ahmed, Yasmin A Mohamoud, Shameem Younuskunju, et al. 2021. “SARS-Cov-2 Antibody-Positivity Protects Against Reinfection for at Least Seven Months with 95% Efficacy.” <em>EClinicalMedicine</em> 35: 100861.</p>
</div>
<div id="ref-diekmann1990definition">
<p>Diekmann, Odo, JAP Heesterbeek, and Johan AJ Metz. 1990. “On the Definition and the Computation of the Basic Reproduction Ratio R0 in Models for Infectious Diseases in Heterogeneous Populations.” <em>Journal of Mathematical Biology</em> 28 (4): 365–82.</p>
</div>
<div id="ref-ferguson2020report">
<p>Ferguson, Neil, Daniel Laydon, Gemma Nedjati Gilani, Natsuko Imai, Kylie Ainslie, Marc Baguelin, Sangeeta Bhatia, et al. 2020. “Report 9: Impact of Non-Pharmaceutical Interventions (Npis) to Reduce Covid19 Mortality and Healthcare Demand.”</p>
</div>
<div id="ref-gallais2021evolution">
<p>Gallais, Floriane, Pierre Gantner, Timothée Bruel, Aurélie Velay, Delphine Planas, Marie-Josée Wendling, Sophie Bayer, et al. 2021. “Evolution of Antibody Responses up to 13 Months After Sars-Cov-2 Infection and Risk of Reinfection.” <em>EBioMedicine</em> 71: 103561.</p>
</div>
<div id="ref-gazit2021comparing">
<p>Gazit, Sivan, Roei Shlezinger, Galit Perez, Roni Lotan, Asaf Peretz, Amir Ben-Tov, Dani Cohen, Khitam Muhsen, Gabriel Chodick, and Tal Patalon. 2021. “Comparing Sars-Cov-2 Natural Immunity to Vaccine-Induced Immunity: Reinfections Versus Breakthrough Infections.” <em>MedRxiv</em>.</p>
</div>
<div id="ref-goldberg2021waning">
<p>Goldberg, Yair, Micha Mandel, Yinon M Bar-On, Omri Bodenheimer, Laurence Freedman, Eric J Haas, Ron Milo, Sharon Alroy-Preis, Nachman Ash, and Amit Huppert. 2021. “Waning Immunity After the Bnt162b2 Vaccine in Israel.” <em>New England Journal of Medicine</em> 385 (24): e85.</p>
</div>
<div id="ref-leidi2021risk">
<p>Leidi, Antonio, Flora Koegler, Roxane Dumont, Richard Dubos, Marı́a-Eugenia Zaballa, Giovanni Piumatti, Matteo Coen, et al. 2021. “Risk of Reinfection After Seroconversion to Sars-Cov-2: A Population-Based Propensity-Score Matched Cohort Study.” <em>medRxiv</em>.</p>
</div>
<div id="ref-ons2021national">
<p>ONS. n.d. “National Life Tables ??? Life Expectancy in the Uk: 2018 to 2020.” <a href="%7Bhttps://www.ons.gov.uk/peoplepopulationandcommunity/birthsdeathsandmarriages/lifeexpectancies/bulletins/nationallifetablesunitedkingdom/2018to2020%7D" class="external-link">{https://www.ons.gov.uk/peoplepopulationandcommunity/birthsdeathsandmarriages/lifeexpectancies/bulletins/nationallifetablesunitedkingdom/2018to2020}</a>.</p>
</div>
<div id="ref-ukpopulation2021">
<p>ONS. n.d. “Overview of the UK population: January 2021.” <a href="%5Curl%7Bhttps://www.ons.gov.uk/peoplepopulationandcommunity/populationandmigration/populationestimates/articles/overviewoftheukpopulation/january2021%7D" class="external-link">\url{https://www.ons.gov.uk/peoplepopulationandcommunity/populationandmigration/populationestimates/articles/overviewoftheukpopulation/january2021}</a>.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by The Como-DTC Development Team.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
