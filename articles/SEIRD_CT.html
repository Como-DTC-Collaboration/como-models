<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="comomodels">
<title>NPIs: contact tracing and quarantining • comomodels</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="NPIs: contact tracing and quarantining">
<meta property="og:description" content="comomodels">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">comomodels</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/SEIRD_age_structured.html">Age-structured model</a>
    <a class="dropdown-item" href="../articles/SEIaImIsRD.html">Asymptomatic, mild and severe symptom compartment model</a>
    <a class="dropdown-item" href="../articles/SEIRD_BD.html">Births and natural deaths and waning natural immunity</a>
    <a class="dropdown-item" href="../articles/SEmIRD.html">Multiple exposed compartments model</a>
    <a class="dropdown-item" href="../articles/SEIRDNPIAge.html">NPIs: age-structured model</a>
    <a class="dropdown-item" href="../articles/SEIRD_CT.html">NPIs: contact tracing and quarantining</a>
    <a class="dropdown-item" href="../articles/SEIRD.html">SEIRD model</a>
    <a class="dropdown-item" href="../articles/SEIRDV.html">Vaccinations model</a>
    <a class="dropdown-item" href="../articles/SEIRDVAge.html">Vaccinations: age-structured model</a>
    <a class="dropdown-item" href="../articles/SEIRD_rural_urban.html">Urban and rural metapopulations model</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Como-DTC-Collaboration/como-models/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">
<script src="SEIRD_CT_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>NPIs: contact tracing and quarantining</h1>
                        <h4 data-toc-skip class="author">Ben Lambert</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Como-DTC-Collaboration/como-models/blob/HEAD/vignettes/SEIRD_CT.Rmd" class="external-link"><code>vignettes/SEIRD_CT.Rmd</code></a></small>
      <div class="d-none name"><code>SEIRD_CT.Rmd</code></div>
    </div>

    
    
<div class="section level1">
<h1 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h1>
<p>Contact tracing, testing and isolation are key elements of many governments’ responses to the COVID-19 pandemic. Some have suggested that well-executed programmes for testing and tracing and quarantining of affected individuals explains how some countries, noticeably some in East Asia, have successfully dealt with the pandemic <span class="citation">(Cohen and Kupferschmidt 2020)</span>.</p>
<p>In this article, we introduce a model that extends the SEIRD model (see <code>Vignette("SEIRD")</code>) which can be used to investigate the importance of this type of non-pharmaceutial intervention.</p>
<p>Since a sizeable proportion of transmission is thought to happen before symptoms occur <span class="citation">(He et al. 2020)</span>, we include a presymptomatic compartment, <span class="math inline">\(P\)</span>, which contributes to infectious. Now the “infectious” compartment, <span class="math inline">\(I\)</span>, represents the symptomatic and infectious individuals.</p>
<p>Although estimates of the importance of asymptomatic individuals to transmission vary widely, there is consensus that they are important reservoirs of transmission <span class="citation">(Byambasuren et al. 2020)</span>. Because of this, we also include an asymptomatic compartment, <span class="math inline">\(A\)</span>, in this model.</p>
<p>The model we assume without any interventions in place has the following structure.</p>
<p><img src="images/seird_ct.png" width="800px"></p>
<p>In this model, the new parameters from the basic SEIRD are <span class="math inline">\(0\leq \eta_a \leq 1\)</span> is the proportion of asymptomatic cases; <span class="math inline">\(1/\omega\)</span> is the typical latent period; <span class="math inline">\(1/\psi\)</span> is the typical time spent transmitting presymptomatically.</p>
<p>We now extend this model to include tracing and isolation. The model assumes that a proportion, <span class="math inline">\(0\leq \phi \leq 1\)</span> of individuals successfully self-isolate when their symptoms appear, spawning no further transmission. It also assumes that a proportion of infected individuals, <span class="math inline">\(0\leq \chi \leq 1\)</span>, who have been traced as contacts of symptomatic infected individuals also successfully isolate. The overall system of ODEs then has the following form:</p>
<p><span class="math display">\[\begin{align}
\frac{\text{d}S}{\text{d}t} &amp;= - (\beta (P + I) + \beta_a A) S,\\
\frac{\text{d}E}{\text{d}t} &amp;= \beta (1 - \chi) (P + I) S + \beta_a A S - \omega E,\\
\frac{\text{d}P}{\text{d}t} &amp;= (1 - \eta_a) \omega E - \psi P,\\
\frac{\text{d}A}{\text{d}t} &amp;= \eta_a \omega E - \gamma A,\\
\frac{\text{d}I}{\text{d}t} &amp;= (1 - \phi) \psi P - (\gamma + \mu) I,\\
\frac{\text{d}E^T}{\text{d}t} &amp;= \beta \chi (P + I) S - \omega E^T,\\
\frac{\text{d}P^T}{\text{d}t} &amp;= (1 - \eta_a) \omega E^T - \psi P^T,\\
\frac{\text{d}A^T}{\text{d}t} &amp;= \eta_a \omega E^T - \gamma A^T,\\
\frac{\text{d}I^T}{\text{d}t} &amp;= \psi P^T + \phi \psi P - (\gamma + \mu) I^T,\\
\frac{\text{d}R}{\text{d}t} &amp;= \gamma (I + I^T + A + A^T),\\
\frac{\text{d}D}{\text{d}t} &amp;= \mu (I + I^T).
\end{align}\]</span></p>
<p>An alternative way of understanding this model structure is to visualise it.</p>
<p><img src="images/seird_ct_full.png" width="800px"></p>
<p>Effectively, this model has two parallel tracts, which are copies of the first model in this vignette: one representing unisolated individuals (i.e. those compartments without the “T”) and those representing quarantining individuals (with a “T”). There are two flows into the quarantined tract: susceptibles can be isolated upon infection <span class="math inline">\(S\rightarrow E^T\)</span> if they are known contacts of an individual who goes on to be symptomatic: i.e. either <span class="math inline">\(P\)</span> or <span class="math inline">\(I\)</span>; or infected individuals can be quarantined once they become symptomatic <span class="math inline">\(P\rightarrow I^T\)</span>.</p>
<div class="section level2">
<h2 id="basic-reproduction-number">Basic reproduction number<a class="anchor" aria-label="anchor" href="#basic-reproduction-number"></a>
</h2>
<p>It can be shown that the basic reproduction number for this model is given by<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Following &lt;span class="citation"&gt;(van den Driessche 2017)&lt;/span&gt; (see &lt;code&gt;Vignette("SEIaImIsRD")&lt;/code&gt; for more information) and assuming a state order: &lt;span class="math inline"&gt;\((E, P, A, I, E^T, P^T, A^T, I^T)\)&lt;/span&gt;, we obtain the matrices: &lt;span class="math display"&gt;\[
F = \left(\begin{array}{cc} 
0 &amp;amp; \beta (1-\chi) &amp;amp; \beta_a &amp;amp; \beta (1-\chi) &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0\\
0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0\\
0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0\\
0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0\\
0 &amp;amp; \beta \chi &amp;amp; 0 &amp;amp; \beta \chi &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0\\
0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0\\
0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0\\
0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0
\end{array}\right),
\]&lt;/span&gt; and &lt;span class="math display"&gt;\[
V = \left(\begin{array}{cc} 
\omega &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0\\
-(1-\eta_a)\omega &amp;amp; \psi &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0\\
-\eta_a\omega &amp;amp; 0 &amp;amp; \gamma &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0\\
0 &amp;amp; -(1-\phi)\psi &amp;amp; 0 &amp;amp; \gamma+\mu &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0\\
0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; \omega &amp;amp; 0 &amp;amp; 0 &amp;amp; 0\\
0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; -(1-\eta_a)\omega &amp;amp; \psi &amp;amp; 0 &amp;amp; 0\\
0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; -\eta_a\omega &amp;amp; 0 &amp;amp; \gamma &amp;amp; 0\\
0 &amp;amp; -\phi\psi &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; -\psi &amp;amp; 0 &amp;amp; \gamma+\mu
\end{array}\right)
\]&lt;/span&gt; The matrix &lt;span class="math inline"&gt;\(K=FV^{-1}\)&lt;/span&gt; is called the next generation matrix and the maximum absolute eigenvalue of it yields the basic reproduction number given in the main text.&lt;/p&gt;'><sup>1</sup></a>:</p>
<p><span class="math display">\[\begin{equation}
R_0 = \eta_a\underbrace{\frac{\beta_a}{\gamma}}_{\text{asymptomatic cases}} + (1 - \eta_a)(1 - \chi) \left[\underbrace{\frac{\beta}{\psi}}_{\text{presymptomatic cases}} + (1-\phi) \underbrace{\frac{\beta}{\gamma+\mu}}_{\text{symptomatic cases}}\right].
\end{equation}\]</span></p>
<p>As the underbraces show in the equation above, this expression has ample intuition behind it. The average number of cases generated from a given infection equates to the sum of: the average cases generated if the infection were asymptomatic, weighted by the probability of a case being asymptomatic; the average number of cases from presymptomatics which are the overall cases which are not asymptomatic <span class="math inline">\((1-\eta_a)\)</span> which are not quarantined due to contact tracing <span class="math inline">\((1-\chi)\)</span>; and those generated from symptomatics for the same overall fraction of cases <span class="math inline">\((1-\eta_a)(1-\chi)\)</span> and who do not self isolate when their symptoms start <span class="math inline">\((1-\phi)\)</span>.</p>
<p>The expression for <span class="math inline">\(R_0\)</span> shows that even if contact tracing and isolation of contacts is perfect (<span class="math inline">\(\chi=1\)</span>), there remains transmission due solely to asymptomatic cases. A meta-analysis concluded that the overall proportion of cases due to asymptomatics is 17% <span class="citation">(Byambasuren et al. 2020)</span>, meaning that if the transmission rate of asymptomaics, <span class="math inline">\(\beta_a\)</span> is high enough (or, although this model does not include it, a longer duration of infection), it is possible to sustain an epidemic solely through asymptomatic transmission: if <span class="math inline">\(\eta \beta_a/\gamma&gt;1\)</span>. This analysis suggests that regular testing, regardless of whether an individual has symptoms, may be an effective way to target asymptomatic reservoirs of infection, if upon testing positive individuals and their close contacts isolate.</p>
<p>What does the expression for <span class="math inline">\(R_0\)</span> suggest about the relevant importance of self isolation of symptomatic individuals versus isolation of contacts of symptomatic individuals? It indicates that the former is much less important than the latter, because self isolation upon being symptomatic only prevents those cases generated by that person whilst they are symptomatic (and they may already have transmitted whilst they were asymptomatic). Whereas if contacts of symptomatic individuals are quarantined, this prevents both presymtpomatic and symptomatic transmission from their contacts. However, it is likely much harder to effectively contact trace individuals and to get these individuals to quarantine than it is to enforce self isolation upon becoming symptomatic.</p>
</div>
<div class="section level2">
<h2 id="contact-tracing-and-isolation-for-ancestral-sars-cov-2-and-the-delta-and-omicron-variants">Contact tracing and isolation for ancestral SARS-CoV-2, and the Delta and Omicron variants<a class="anchor" aria-label="anchor" href="#contact-tracing-and-isolation-for-ancestral-sars-cov-2-and-the-delta-and-omicron-variants"></a>
</h2>
<p>We now compare the utility of these NPIs for containing COVID-19 transmission. For ancestral SARS-CoV-2, an average duration of presymptomatic infectiousness was estimated as 3 days <span class="citation">(He et al. 2020)</span>, representing roughly 55% of the latent period <span class="citation">(Xin et al. 2021)</span>. Whilst this is a rough assumption, lacking data, we assume the same fraction of the latent period represents presymptomatic infectiousness for the Delta and Omicron variants.</p>
<p>We assume that 17% of cases are asymptomatic: meaning <span class="math inline">\(\eta_a=0.17\)</span> <span class="citation">(Byambasuren et al. 2020)</span>. A meta-analysis attempting to determine the relative infectiousness of asymptomatic cases versus symptomatic found estimates in the literature ranging from 0 to 1 <span class="citation">(McEvoy et al. 2021)</span>, however, some of the studies they analysed had only a handful of estimates. A study of an outbreak of COVID-19 in marine recruits used qPCR as a proxy for viral load and found that it was approximately four times higher in symptomatic opposed to asymptomatic carries <span class="citation">(Letizia et al. 2020)</span>, as such, we set <span class="math inline">\(\beta_a=0.25\beta\)</span>.</p>
<p>We first find transmission parameters across all variants assuming that no NPIs are in place. Note, this requires us to find beta values which match given <span class="math inline">\(R_0\)</span> values for each variant, which we do via optimisation (through <code>optim</code>).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Como-DTC-Collaboration/como-models" class="external-link">comomodels</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span>
<span class="co">#&gt; ── <span style="font-weight: bold;">Attaching packages</span> ─────────────────────────────────────── tidyverse 1.3.1 ──</span>
<span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">ggplot2</span> 3.3.5     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">purrr  </span> 0.3.4</span>
<span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble </span> 3.1.6     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr  </span> 1.0.7</span>
<span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr  </span> 1.1.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">stringr</span> 1.4.0</span>
<span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">readr  </span> 2.1.1     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">forcats</span> 0.5.1</span>
<span class="co">#&gt; ── <span style="font-weight: bold;">Conflicts</span> ────────────────────────────────────────── tidyverse_conflicts() ──</span>
<span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span> masks <span style="color: #0000BB;">stats</span>::filter()</span>
<span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>    masks <span style="color: #0000BB;">stats</span>::lag()</span>

<span class="co"># helper functions</span>
<span class="va">R0_calculator</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">beta</span>, <span class="va">gamma</span>, <span class="va">mu</span>, <span class="va">chi</span>, <span class="va">phi</span>, <span class="va">omega</span>, <span class="va">eta_a</span>, <span class="va">psi</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SEIRD_CT-class.html">SEIRD_CT</a></span><span class="op">(</span><span class="op">)</span>
  <span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta<span class="op">=</span><span class="va">beta</span>,
                 beta_a<span class="op">=</span><span class="fl">0.25</span> <span class="op">*</span> <span class="va">beta</span>,
                 gamma<span class="op">=</span><span class="va">gamma</span>,
                 mu<span class="op">=</span><span class="va">mu</span>,
                 chi<span class="op">=</span><span class="va">chi</span>,
                 phi<span class="op">=</span><span class="va">phi</span>,
                 omega<span class="op">=</span><span class="va">omega</span>,
                 eta_a<span class="op">=</span><span class="va">eta_a</span>,
                 psi<span class="op">=</span><span class="va">psi</span><span class="op">)</span>
  <span class="fu"><a href="../reference/transmission_parameters.html">transmission_parameters</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">params</span>
  <span class="fu"><a href="../reference/R0.html">R0</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">find_beta</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">R0_target</span>, <span class="va">gamma</span>, <span class="va">mu</span>, <span class="va">chi</span>, <span class="va">phi</span>, <span class="va">omega</span>, <span class="va">eta_a</span>, <span class="va">psi</span><span class="op">)</span><span class="op">{</span>
  <span class="va">f_beta</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">beta</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">R0_test</span> <span class="op">&lt;-</span> <span class="fu">R0_calculator</span><span class="op">(</span><span class="va">beta</span>, <span class="va">gamma</span>, <span class="va">mu</span>, <span class="va">chi</span>, <span class="va">phi</span>, <span class="va">omega</span>, <span class="va">eta_a</span>, <span class="va">psi</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">R0_test</span> <span class="op">-</span> <span class="va">R0_target</span><span class="op">)</span>
  <span class="op">}</span>
  
  <span class="co"># minimise difference between target and actual R0</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">f_beta</span><span class="op">)</span><span class="op">$</span><span class="va">par</span>
<span class="op">}</span>

<span class="co"># parameters assumed same across all variants</span>
<span class="va">chi</span> <span class="op">&lt;-</span> <span class="fl">0</span>
<span class="va">phi</span> <span class="op">&lt;-</span> <span class="fl">0</span>
<span class="va">eta_a</span> <span class="op">&lt;-</span> <span class="fl">0.17</span>
<span class="va">inits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
  S0<span class="op">=</span><span class="fl">0.999</span>, E0<span class="op">=</span><span class="fl">0</span>, P0<span class="op">=</span><span class="fl">0</span>, A0<span class="op">=</span><span class="fl">0</span>, I0<span class="op">=</span><span class="fl">0.001</span>,
  Et0<span class="op">=</span><span class="fl">0</span>, Pt0<span class="op">=</span><span class="fl">0</span>, At0<span class="op">=</span><span class="fl">0</span>, It0<span class="op">=</span><span class="fl">0</span>, R0<span class="op">=</span><span class="fl">0</span><span class="op">)</span>

<span class="co"># ancestral</span>
<span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/covid_transmission_parameters.html">covid_transmission_parameters</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">kappa</span> <span class="op">&lt;-</span> <span class="va">params</span><span class="op">$</span><span class="va">kappa</span>
<span class="va">latent_period</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">kappa</span>
<span class="va">presymptomatic_period</span> <span class="op">&lt;-</span> <span class="fl">3</span>
<span class="va">psi</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">presymptomatic_period</span>
<span class="va">omega</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="va">latent_period</span> <span class="op">-</span> <span class="va">presymptomatic_period</span><span class="op">)</span>
<span class="va">fraction_infectious</span> <span class="op">&lt;-</span> <span class="va">presymptomatic_period</span> <span class="op">/</span> <span class="va">latent_period</span>
<span class="va">gamma</span> <span class="op">&lt;-</span> <span class="va">params</span><span class="op">$</span><span class="va">gamma</span>
<span class="va">mu</span> <span class="op">&lt;-</span> <span class="va">params</span><span class="op">$</span><span class="va">mu</span>
<span class="va">R0_target</span> <span class="op">&lt;-</span> <span class="va">params</span><span class="op">$</span><span class="va">R0</span>
<span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu">find_beta</span><span class="op">(</span><span class="va">R0_target</span>, <span class="va">gamma</span>, <span class="va">mu</span>, <span class="va">chi</span>, <span class="va">phi</span>, <span class="va">omega</span>, <span class="va">eta_a</span>, <span class="va">psi</span><span class="op">)</span>
<span class="co">#&gt; Warning in optim(1, f_beta): one-dimensional optimization by Nelder-Mead is unreliable:</span>
<span class="co">#&gt; use "Brent" or optimize() directly</span>
<span class="va">beta_a</span> <span class="op">&lt;-</span> <span class="fl">0.25</span> <span class="op">*</span> <span class="va">beta</span>
<span class="va">params_ancestral</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta<span class="op">=</span><span class="va">beta</span>,
               beta_a<span class="op">=</span><span class="va">beta_a</span>,
               gamma<span class="op">=</span><span class="va">gamma</span>,
               mu<span class="op">=</span><span class="va">mu</span>,
               chi<span class="op">=</span><span class="va">chi</span>,
               phi<span class="op">=</span><span class="va">phi</span>,
               omega<span class="op">=</span><span class="va">omega</span>,
               eta_a<span class="op">=</span><span class="va">eta_a</span>,
               psi<span class="op">=</span><span class="va">psi</span><span class="op">)</span>

<span class="co"># gets parameters for a variant</span>
<span class="va">get_parameters_variant</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">variant_name</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/covid_transmission_parameters.html">covid_transmission_parameters</a></span><span class="op">(</span>variant<span class="op">=</span><span class="va">variant_name</span><span class="op">)</span>
  <span class="va">kappa</span> <span class="op">&lt;-</span> <span class="va">params</span><span class="op">$</span><span class="va">kappa</span>
  <span class="va">latent_period</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">kappa</span>
  <span class="co"># assumes same fraction presymptomatic as for ancestral</span>
  <span class="va">presymptomatic_period</span> <span class="op">&lt;-</span> <span class="va">latent_period</span> <span class="op">*</span> <span class="va">fraction_infectious</span>
  <span class="va">psi</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">presymptomatic_period</span>
  <span class="va">omega</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="va">latent_period</span> <span class="op">-</span> <span class="va">presymptomatic_period</span><span class="op">)</span>
  <span class="va">gamma</span> <span class="op">&lt;-</span> <span class="va">params</span><span class="op">$</span><span class="va">gamma</span>
  <span class="va">mu</span> <span class="op">&lt;-</span> <span class="va">params</span><span class="op">$</span><span class="va">mu</span>
  <span class="va">R0_target</span> <span class="op">&lt;-</span> <span class="va">params</span><span class="op">$</span><span class="va">R0</span>
  <span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu">find_beta</span><span class="op">(</span><span class="va">R0_target</span>, <span class="va">gamma</span>, <span class="va">mu</span>, <span class="va">chi</span>, <span class="va">phi</span>, <span class="va">omega</span>, <span class="va">eta_a</span>, <span class="va">psi</span><span class="op">)</span>
  <span class="va">beta_a</span> <span class="op">&lt;-</span> <span class="fl">0.25</span> <span class="op">*</span> <span class="va">beta</span>
  
  <span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SEIRD_CT-class.html">SEIRD_CT</a></span><span class="op">(</span><span class="op">)</span>
  <span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta<span class="op">=</span><span class="va">beta</span>,
                 beta_a<span class="op">=</span><span class="va">beta_a</span>,
                 gamma<span class="op">=</span><span class="va">gamma</span>,
                 mu<span class="op">=</span><span class="va">mu</span>,
                 chi<span class="op">=</span><span class="va">chi</span>,
                 phi<span class="op">=</span><span class="va">phi</span>,
                 omega<span class="op">=</span><span class="va">omega</span>,
                 eta_a<span class="op">=</span><span class="va">eta_a</span>,
                 psi<span class="op">=</span><span class="va">psi</span><span class="op">)</span>
  <span class="va">params</span>
<span class="op">}</span>

<span class="va">params_delta</span> <span class="op">&lt;-</span> <span class="fu">get_parameters_variant</span><span class="op">(</span><span class="st">"delta"</span><span class="op">)</span>
<span class="co">#&gt; Warning in optim(1, f_beta): one-dimensional optimization by Nelder-Mead is unreliable:</span>
<span class="co">#&gt; use "Brent" or optimize() directly</span>
<span class="va">params_omicron</span> <span class="op">&lt;-</span> <span class="fu">get_parameters_variant</span><span class="op">(</span><span class="st">"omicron"</span><span class="op">)</span>
<span class="co">#&gt; Warning in optim(1, f_beta): one-dimensional optimization by Nelder-Mead is unreliable:</span>
<span class="co">#&gt; use "Brent" or optimize() directly</span></code></pre></div>
<p>Now we run the <code>SEIRD_CT</code> model for each of the variants. We compare a number of scenarios: a base scenario where we do nothing; a “self isolation” scenario where self isolation upon becoming symptomatic is the only NPI in place, and that 50% of people follow this: <span class="math inline">\(\chi=0\)</span> and <span class="math inline">\(\phi=0.5\)</span>; a “contact tracing scenario” where 50% of symptomatic individuals have their contacts traced and all these isolate: <span class="math inline">\(\chi=0.5\)</span> and <span class="math inline">\(\phi=0.0\)</span>; and a scenario where we do implement both of the aforementioned NPIs. Note, reaching 50% of symptomatic individuals and getting all of their contacts to isolate is likely unrealistic, but we keep this figure here to directly compare this NPI with self isolation only.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># helper functions to run model for all variants</span>
<span class="va">run_model</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">chi</span>, <span class="va">phi</span>, <span class="va">params</span>, <span class="va">inits</span>, <span class="va">times</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">365</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SEIRD_CT-class.html">SEIRD_CT</a></span><span class="op">(</span><span class="op">)</span>
  <span class="va">params</span><span class="op">$</span><span class="va">chi</span> <span class="op">&lt;-</span> <span class="va">chi</span>
  <span class="va">params</span><span class="op">$</span><span class="va">phi</span> <span class="op">&lt;-</span> <span class="va">phi</span>
  <span class="fu"><a href="../reference/transmission_parameters.html">transmission_parameters</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">params</span>
  <span class="fu"><a href="../reference/initial_conditions.html">initial_conditions</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">inits</span>
  <span class="va">outputs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">times</span><span class="op">)</span>
  <span class="va">outputs</span><span class="op">$</span><span class="va">changes</span>
<span class="op">}</span>

<span class="va">run_all_variants</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">chi</span>, <span class="va">phi</span>, <span class="va">scenario</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">changes_ancestral</span> <span class="op">&lt;-</span> <span class="fu">run_model</span><span class="op">(</span>
    chi<span class="op">=</span><span class="va">chi</span>, phi<span class="op">=</span><span class="va">phi</span>, <span class="va">params_ancestral</span>, <span class="va">inits</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>variant<span class="op">=</span><span class="st">"ancestral"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>scenario<span class="op">=</span><span class="va">scenario</span><span class="op">)</span>
  <span class="va">changes_delta</span> <span class="op">&lt;-</span> <span class="fu">run_model</span><span class="op">(</span>
    chi<span class="op">=</span><span class="va">chi</span>, phi<span class="op">=</span><span class="va">phi</span>, <span class="va">params_delta</span>, <span class="va">inits</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>variant<span class="op">=</span><span class="st">"Delta"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>scenario<span class="op">=</span><span class="va">scenario</span><span class="op">)</span>
  <span class="va">changes_omicron</span> <span class="op">&lt;-</span> <span class="fu">run_model</span><span class="op">(</span>
    chi<span class="op">=</span><span class="va">chi</span>, phi<span class="op">=</span><span class="va">phi</span>, <span class="va">params_omicron</span>, <span class="va">inits</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>variant<span class="op">=</span><span class="st">"Omicron"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>scenario<span class="op">=</span><span class="va">scenario</span><span class="op">)</span>
  <span class="va">changes_ancestral</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">changes_delta</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">changes_omicron</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># different policy mixes</span>
<span class="va">policies</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"do nothing"</span>,
              <span class="st">"self isolation"</span>,
              <span class="st">"contact tracing"</span>,
              <span class="st">"self isolation \n+ contact tracing"</span><span class="op">)</span>
<span class="va">policy_parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>policy<span class="op">=</span><span class="va">policies</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>chi<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>,
         phi<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>

<span class="co"># run all models</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">policies</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
 <span class="va">changes</span> <span class="op">&lt;-</span> <span class="fu">run_all_variants</span><span class="op">(</span>
   <span class="va">policy_parameters</span><span class="op">$</span><span class="va">chi</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,
   <span class="va">policy_parameters</span><span class="op">$</span><span class="va">phi</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,
   <span class="va">policy_parameters</span><span class="op">$</span><span class="va">policy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>
 <span class="kw">if</span><span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span>
   <span class="va">big_df</span> <span class="op">&lt;-</span> <span class="va">changes</span>
 <span class="op">}</span> <span class="kw">else</span><span class="op">{</span>
   <span class="va">big_df</span> <span class="op">&lt;-</span> <span class="va">big_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">changes</span><span class="op">)</span>
 <span class="op">}</span>
<span class="op">}</span>

<span class="co"># plot</span>
<span class="va">big_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>  
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>scenario<span class="op">=</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html" class="external-link">fct_relevel</a></span><span class="op">(</span><span class="va">scenario</span>, <span class="va">policies</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">compartment</span><span class="op">==</span><span class="st">"Incidence"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">time</span>, y<span class="op">=</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">variant</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">scenario</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"time (days)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"case fraction"</span><span class="op">)</span></code></pre></div>
<p><img src="SEIRD_CT_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<p>From the above plot, it is evident that the contact tracing scenario is more effective at reducing the peak case load than the self isolation scenario, and that implementing both of these NPIs has an even greater impact. For ancestral COVID-19, indeed, it appears that the scenario where both of these are implemented is sufficient to avoid an epidemic altogether. For Delta and Omicron, however, epidemics are diminished although remain – for these variants, the transmission rate is so high that even the unrealistically effective NPI policies we consider cannot quash transmission alone.</p>
<p>Comparing the R0 values under these policies, the results above are explicated: an epidemic can only be avoided for the ancestral strain when both NPIs are in place.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># helper functions to find R0</span>
<span class="va">find_R0</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">chi</span>, <span class="va">phi</span>, <span class="va">params</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SEIRD_CT-class.html">SEIRD_CT</a></span><span class="op">(</span><span class="op">)</span>
  <span class="va">params</span><span class="op">$</span><span class="va">chi</span> <span class="op">&lt;-</span> <span class="va">chi</span>
  <span class="va">params</span><span class="op">$</span><span class="va">phi</span> <span class="op">&lt;-</span> <span class="va">phi</span>
  <span class="fu"><a href="../reference/transmission_parameters.html">transmission_parameters</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">params</span>
  <span class="fu"><a href="../reference/R0.html">R0</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">find_R0_all_variants</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">chi</span>, <span class="va">phi</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">R0_ancestral</span> <span class="op">&lt;-</span> <span class="fu">find_R0</span><span class="op">(</span><span class="va">chi</span>, <span class="va">phi</span>, <span class="va">params_ancestral</span><span class="op">)</span>
  <span class="va">R0_delta</span> <span class="op">&lt;-</span> <span class="fu">find_R0</span><span class="op">(</span><span class="va">chi</span>, <span class="va">phi</span>, <span class="va">params_delta</span><span class="op">)</span>
  <span class="va">R0_omicron</span> <span class="op">&lt;-</span> <span class="fu">find_R0</span><span class="op">(</span><span class="va">chi</span>, <span class="va">phi</span>, <span class="va">params_omicron</span><span class="op">)</span>
  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>
    ancestral<span class="op">=</span><span class="va">R0_ancestral</span>,
    Delta<span class="op">=</span><span class="va">R0_delta</span>,
    Omicron<span class="op">=</span><span class="va">R0_omicron</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># calculate R0s</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">policy_parameters</span><span class="op">$</span><span class="va">policy</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">temp_df</span> <span class="op">&lt;-</span> <span class="fu">find_R0_all_variants</span><span class="op">(</span>
    chi<span class="op">=</span><span class="va">policy_parameters</span><span class="op">$</span><span class="va">chi</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,
    phi<span class="op">=</span><span class="va">policy_parameters</span><span class="op">$</span><span class="va">phi</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>scenario<span class="op">=</span><span class="va">policy_parameters</span><span class="op">$</span><span class="va">policy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>
    <span class="va">big_df</span> <span class="op">&lt;-</span> <span class="va">temp_df</span>
  <span class="kw">else</span>
    <span class="va">big_df</span> <span class="op">&lt;-</span> <span class="va">big_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">temp_df</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># plot</span>
<span class="va">big_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>scenario<span class="op">=</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html" class="external-link">fct_relevel</a></span><span class="op">(</span><span class="va">scenario</span>, <span class="va">policies</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="va">ancestral</span><span class="op">:</span><span class="va">Omicron</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>variant<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">scenario</span>, y<span class="op">=</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">1</span>, linetype<span class="op">=</span><span class="fl">2</span>,
             colour<span class="op">=</span><span class="st">"orange"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"R0"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">variant</span>, scales<span class="op">=</span><span class="st">"free"</span><span class="op">)</span></code></pre></div>
<p><img src="SEIRD_CT_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
</div>
<div class="section level2 unnumbered">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references">
<div id="ref-byambasuren2020estimating">
<p>Byambasuren, Oyungerel, Magnolia Cardona, Katy Bell, Justin Clark, Mary-Louise McLaws, and Paul Glasziou. 2020. “Estimating the Extent of Asymptomatic Covid-19 and Its Potential for Community Transmission: Systematic Review and Meta-Analysis.” <em>Official Journal of the Association of Medical Microbiology and Infectious Disease Canada</em> 5 (4): 223–34.</p>
</div>
<div id="ref-cohen2020countries">
<p>Cohen, Jon, and Kai Kupferschmidt. 2020. “Countries Test Tactics in "War" Against Covid-19.”</p>
</div>
<div id="ref-he2020temporal">
<p>He, Xi, Eric HY Lau, Peng Wu, Xilong Deng, Jian Wang, Xinxin Hao, Yiu Chung Lau, et al. 2020. “Temporal Dynamics in Viral Shedding and Transmissibility of Covid-19.” <em>Nature Medicine</em> 26 (5): 672–75.</p>
</div>
<div id="ref-letizia2020sars">
<p>Letizia, Andrew G, Irene Ramos, Ajay Obla, Carl Goforth, Dawn L Weir, Yongchao Ge, Marcas M Bamman, et al. 2020. “SARS-Cov-2 Transmission Among Marine Recruits During Quarantine.” <em>New England Journal of Medicine</em> 383 (25): 2407–16.</p>
</div>
<div id="ref-mcevoy2021relative">
<p>McEvoy, David, Conor McAloon, Aine Collins, Kevin Hunt, Francis Butler, Andrew Byrne, Miriam Casey-Bryars, et al. 2021. “Relative Infectiousness of Asymptomatic Sars-Cov-2 Infected Persons Compared with Symptomatic Individuals: A Rapid Scoping Review.” <em>BMJ Open</em> 11 (5): e042354.</p>
</div>
<div id="ref-vandenDriessche17">
<p>van den Driessche, Pauline. 2017. “Reproduction Numbers of Infectious Disease Models.” <em>Infectious Disease Modelling</em> 2 (3): 288–303. <a href="https://doi.org/10.1016/j.idm.2017.06.002" class="external-link">https://doi.org/10.1016/j.idm.2017.06.002</a>.</p>
</div>
<div id="ref-Xin21">
<p>Xin, Hualei, Yu Li, Peng Wu, Zhili Li, Eric H Y Lau, Ying Qin, Liping Wang, Benjamin J Cowling, Tim K Tsang, and Zhongjie Li. 2021. “Estimating the Latent Period of Coronavirus Disease 2019 (COVID-19).” <em>Clinical Infectious Diseases</em>, September. <a href="https://doi.org/10.1093/cid/ciab746" class="external-link">https://doi.org/10.1093/cid/ciab746</a>.</p>
</div>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by The Como-DTC Development Team.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
