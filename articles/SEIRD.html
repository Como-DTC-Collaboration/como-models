<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="comomodels">
<title>SEIRD model • comomodels</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="SEIRD model">
<meta property="og:description" content="comomodels">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">comomodels</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/SEIRD_age_structured.html">Age-structured model</a>
    <a class="dropdown-item" href="../articles/SEIaImIsRD.html">Asymptomatic, mild and severe symptom compartment model</a>
    <a class="dropdown-item" href="../articles/SEIRD_BD.html">Births and natural deaths and waning natural immunity</a>
    <a class="dropdown-item" href="../articles/SEmIRD.html">Multiple exposed compartments model</a>
    <a class="dropdown-item" href="../articles/SEIRDNPIAge.html">NPIs: age-structured model</a>
    <a class="dropdown-item" href="../articles/SEIRD_CT.html">NPIs: contact tracing and quarantining</a>
    <a class="dropdown-item" href="../articles/SEIRD.html">SEIRD model</a>
    <a class="dropdown-item" href="../articles/SEIRDV.html">Vaccinations model</a>
    <a class="dropdown-item" href="../articles/SEIRDVAge.html">Vaccinations: age-structured model</a>
    <a class="dropdown-item" href="../articles/SEIRD_rural_urban.html">Urban and rural metapopulations model</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">
<script src="SEIRD_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>SEIRD model</h1>
                        <h4 data-toc-skip class="author">Hui Jia Farm, Solveig A. van der Vegt and Ben Lambert</h4>
            
      
      
      <div class="d-none name"><code>SEIRD.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This document introduces the deterministic SEIRD model, which is the foundation around which many, more advanced models of COVID-19 transmission dynamics are based (including all the other models within this package). In this vignette, we explain what this model represents, and we show how it can be used to understand epidemic dynamics typical of the “waves” of infection seen during the COVID-19 pandemic.</p>
</div>
<div class="section level2">
<h2 id="the-seird-model">The SEIRD Model<a class="anchor" aria-label="anchor" href="#the-seird-model"></a>
</h2>
<p>The SEIRD model is an example of a compartmental model in mathematical epidemiology <span class="citation">(Anderson and May 1992)</span>. In these types of models, individuals are assumed at a particular point in time to belong to only one of a number of “compartments”: discrete containers where all individuals within them are assumed to be in the same state. In an SEIRD model, there are five such compartments / states: Susceptible, Exposed, Infectious, Recovered and Dead. Susceptible individuals (<span class="math inline">\(S\)</span>) have not been exposed to the virus. Exposed individuals (<span class="math inline">\(E\)</span>) have been exposed to the virus and have been infected but are not yet infectious to others – they are in the latent period. Infectious individuals (<span class="math inline">\(I\)</span>) can spread the virus to others. Recovered individuals (<span class="math inline">\(R\)</span>) are no longer infectious, and, in this model, have acquired immunity as they do not return to the susceptible population. Some individuals, however, unfortunately do not recover from infection and die as a result, falling into the dead state (<span class="math inline">\(D\)</span>).</p>
<p>By assuming that individuals belong only to one of these states, the model effectively assumes that all other information outside of these states is unimportant for transmission. So, an individual’s age, their location and any pre-existing medical conditions they may have are, for example, unnaccounted for in this model. In COVID-19 transmission, this assumption is unlikely to hold, since we know that individuals’ age does, for instance, strongly influence their susceptibility to death <span class="citation">(Verity et al. 2020)</span>. The SEIRD model can, however, still be used to approximate the aggregate dynamics of the population since it captures the dominant features of human-to-human epidemic dynamics.</p>
<p>In compartmental models, individuals can move between these states following one of a predefined set of paths. In the SEIRD model, susceptible individuals can become infected with the virus after exposure to it from an infectious individual. In doing so, they can move from the susceptible compartment to the exposed, as is illustrated in the left-hand nodes of the below graph as indicated by the <span class="math inline">\(S\rightarrow E\)</span> transition.</p>
<p><img src="images/seird.png" width="400px"></p>
<p>Exposed (<span class="math inline">\(E\)</span>) individuals then become infectious (<span class="math inline">\(I\)</span>) over time as they transition out of the latent period. For infectious individuals, there are two potential transitions: either an individual recovers and they enter the recovered state (<span class="math inline">\(R\)</span>) where they remain forever; or they die, entering the dead state (<span class="math inline">\(D\)</span>).</p>
<p>For all models in this package, it is assumed that the population size is sufficiently large that we can view the number of individuals in a given compartment on a continuous scale. We also assume that the process governing the dynamics is deterministic: that is, given the current state of the system (i.e. the numbers of individuals in the <span class="math inline">\(S\)</span>, <span class="math inline">\(E\)</span>, <span class="math inline">\(I\)</span>, <span class="math inline">\(R\)</span> and <span class="math inline">\(D\)</span> compartments), we can perfectly forecast its future behaviour. In reality, this is unlikely to hold since our model neglects to consider a myriad of factors that can influence the resultant epidemic. Indeed, stochastic models try to account for these unobserved elements by assuming randomness plays a role in the underlying dynamics. Nevertheless, in many instances, particularly when a population size is large, assuming deterministic system dynamics may give a good approximation of the mean of equivalent stochastic systems <span class="citation">(Erban, Chapman, and Maini 2007)</span>.</p>
<p>Additionally, the modelling framework that we use assumes that the system changes continuously over time. Specifically, the system assumes that changes in the compartments are governed by a system of coupled ordinary differential equations (ODEs). An example of such an equation is:</p>
<p><span class="math display">\[\frac{\text{d}S}{\text{d}t} = -\text{newly exposed} = -\beta S I,\]</span></p>
<p>where the left-hand side gives the rate of growth of the susceptible compartment. Since, here, we have not modelled births nor natural deaths (i.e. non-COVID-19 deaths), the only way in which the number of susceptible individuals changes is through those individuals becoming exposed to infection. In this model, we assume that individuals are “well-mixed” – that is, that a susceptible individual can potentially contact with any infected individual in the population: this means that there are <span class="math inline">\(S * I\)</span> contacts between susceptible and infected individuals at a point in time. Note, this is unlikely to be the case in reality, since populations are highly structured, both geographically and societally, meaning that individuals interact mostly with people in their immediate social group. In the model, the rate at which contacts between a susceptible and infected individual results in transmission is given by <span class="math inline">\(\beta&gt;0\)</span>, meaning that the overall rate that susceptibles become exposed is given by <span class="math inline">\(\beta * S * I\)</span>. Because this leads to a decline in the susceptible group size, we require a minus sign in the above equation for <span class="math inline">\(\frac{\text{d}S}{\text{d}t}\)</span>.</p>
<p>Note that <span class="math inline">\(\beta\)</span> is a rate (per unit time) at which a susceptible individual becomes infected on contact with an infected individual. It is not a probability as it is sometimes mistakenly labelled and so <span class="math inline">\(\beta &gt; 1\)</span> is possible.</p>
<p>The full SEIRD model consists of four ODEs that are coupled together: the first of these governs the behaviour of susceptible individuals, which has already been introduced. The next equation governs the growth of the exposed compartment:</p>
<p><span class="math display">\[\frac{\text{d}E}{\text{d}t} = \text{newly exposed} - \text{newly infectious} = \beta S I -\kappa E,\]</span> where the rate of change is given by the difference between the flow into this compartment due to those individuals who have been newly exposed and the flow out of it, through those who have newly become infectious. (These represent the two arrows going into and out of the <span class="math inline">\(E\)</span> compartment in the arrow graph above.)</p>
<p>The next compartment we consider is the infectious. This compartment grows in size as newly infectious individuals flow into it; over time, some infectious recover and, unfortunately, others die, both of which reduce the growth rate:</p>
<p><span class="math display">\[\frac{\text{d}I}{\text{d}t} = \text{newly infectious} - \text{newly recovered} - \text{deaths} = \kappa E - (\gamma + \mu) I,\]</span></p>
<p>Here, <span class="math inline">\(\gamma&gt;0\)</span> dictates the rate at which infectious individuals recover; <span class="math inline">\(\mu&gt;0\)</span> dictates the rate of death from infection.</p>
<p>The final two compartments are for the recovered and dead individuals and take the form:</p>
<p><span class="math display">\[\frac{\text{d}R}{\text{d}t} = \text{newly recovered} = \gamma I,\]</span> <span class="math display">\[\frac{\text{d}D}{\text{d}t} = \text{deaths} = \mu I.\]</span></p>
<p>We note that natural births and deaths – in other words, those unrelated to infection – are not considered in this model. Therefore, the SEIRD model is suitable only to diseases that span a short period of time, when natural births and deaths do not significantly affect the stock of susceptible individuals.</p>
<p>Overall, then, the system ODEs describing how the compartment populations evolve over time is:</p>
<p><span class="math display">\[\frac{\text{d}S}{\text{d}t} = -\beta S I,\]</span> <span class="math display">\[\frac{\text{d}E}{\text{d}t} = \beta S I -\kappa E,\]</span> <span class="math display">\[\frac{\text{d}I}{\text{d}t} =\kappa E - (\gamma + \mu) I,\]</span></p>
<p><span class="math display">\[\frac{\text{d}R}{\text{d}t} = \gamma I,\]</span> <span class="math display">\[\frac{\text{d}D}{\text{d}t} = \mu I.\]</span></p>
<p>Having specified the form of the growth rate for each of the compartments, we need to specify the initial sizes of each of the compartments, which we do via the initial conditions:</p>
<p><span class="math display">\[S(0) = S_\text{init},\ E(0) = E_\text{init},\ I(0) = I_\text{init},\ R(0) = R_\text{init},\ D(0) = D_\text{init}.\]</span></p>
<p>With both the system of ODEs and initial conditions specified, we can solve for the states over time, resulting in <span class="math inline">\(S(t), E(t), I(t), R(t)\)</span> and <span class="math inline">\(D(t)\)</span>. Since the system of ODEs has no analytic solution, the system is solved numerically, using a numerical integrator. In this package, we use the R package <code>deSolve</code> <span class="citation">(Soetaert, Petzoldt, and Setzer 2010)</span> to numerically integrate the system, and the user can specify which of its numerical integrators to use (by default, it is the LSODA <span class="citation">(Petzold 1983)</span>).</p>
<p>In the implementation of the model in this package, the variables are normalized so<span class="math inline">\(S(t) + E(t) + I(t) + R(t) + D(t) \equiv 1\)</span> for any given <span class="math inline">\(t\)</span>. This means that each of these state variables represents the fraction of the population in each of these states at a given point in time.</p>
<p>Typical epidemic data includes the number of new cases or new deaths occurring over a time interval. Here, we define “cases” to mean someone infected with the virus<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Note, that other definitions of cases are possible, however. For example, a “case” can refer to a clinical case – i.e. someone presenting with symptoms.&lt;/p&gt;"><sup>1</sup></a>. To calculate the number of cases arising over a time period, we track the cumulative number of cases through the following equation:</p>
<p><span class="math display">\[\frac{\text{d}C}{\text{d}t} = \text{newly exposed} = \beta S I,\]</span> where we assume <span class="math inline">\(C(0) = 0\)</span>. The number of new infections arising between two time intervals <span class="math inline">\(t_1\)</span> and <span class="math inline">\(t_2\)</span> is then: <span class="math inline">\(C(t_2) - C(t_1)\)</span>. Similarly, the number of deaths occuring over the same interval is the difference in the cumulative deaths: <span class="math inline">\(D(t_2) - D(t_1)\)</span>.</p>
</div>
<div class="section level2">
<h2 id="steady-states">Steady states<a class="anchor" aria-label="anchor" href="#steady-states"></a>
</h2>
<p>We can now consider whether there are equilibrium states of the system: values of the state variables where, unless perturbed, the system will remain where it is. To do so, we set the right-hand sides of the ODEs to zero. Taking the equation for the susceptibles:</p>
<p><span class="math display">\[\frac{\text{d}S}{\text{d}t} = -\beta S I = 0.\]</span></p>
<p>This only has solutions if either <span class="math inline">\(S=0\)</span>, in which case there are no individuals left to infect; or <span class="math inline">\(I=0\)</span>, in which case there are no infectious individuals: in other words, an infection has not been imported into the population. Considering all four ODEs, <span class="math inline">\(I=0\)</span> implies that <span class="math inline">\(\frac{\text{d}R}{\text{d}t} = 0\)</span> and <span class="math inline">\(\frac{\text{d}D}{\text{d}t} = 0\)</span>. Additionally, so long as there are no exposed individuals, <span class="math inline">\(\frac{\text{d}E}{\text{d}t}= 0\)</span> and <span class="math inline">\(\frac{\text{d}I}{\text{d}t}= 0\)</span> and So the equilibria are given by <span class="math inline">\(S=S'\)</span>, <span class="math inline">\(E=0\)</span>, and <span class="math inline">\(I=0\)</span> which corresponds to a situation when there are no infected or infectious individuals in the population. In other words, in this model, there is no endemic equilibrium when the infection remains present throughout the population; only epidemic dynamics are possible.</p>
</div>
<div class="section level2">
<h2 id="using-an-seird-model-to-simulate-covid-19-dynamics">Using an SEIRD model to simulate COVID-19 dynamics<a class="anchor" aria-label="anchor" href="#using-an-seird-model-to-simulate-covid-19-dynamics"></a>
</h2>
<p>We now show how <code>comomodels</code> can be used to create an SEIRD which captures the dominant characteristics of an unmitigated COVID-19 epidemic.</p>
<p>We first create an <code>SEIRD</code> object that we will use to run simulations.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SEIRD-class.html">SEIRD</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>The most crucial step in using compartmental models of transmission dynamics is their parameterisation because different parameter ranges allow both qualitatively and quantitatively different dynamics. There are two ways to estimate the parameters of such models: i) to use data collected in the laboratory or field to estimate individual parameters; or ii) to fit these models to field data and, in doing so, estimate potentially a collective of parameters. There are limitations to both approaches. The first does not account for how uncertainty in one parameter might influence our estimates of another: a higher value of <span class="math inline">\(\beta\)</span> can be offset by an increased value of <span class="math inline">\(\mu\)</span> to result in similar case counts, for instance. The second approach generally only allows a subset of parameters to be estimated, since the available data are sparse and insufficient to jointly determine all.</p>
<p>The crucial thing, however, is that both approaches use data to determine parameters. And for practically all infectious diseases modelled, the available data do not pin down a model’s parameters to a single set. It is thus important to determine whether the conclusions of modelling – whether a new viral variant will lead a country’s healthcare infrastructure to be overrun, for instance – are sensitive to the parameter choices assumed.</p>
<p>Here, we follow the first approach to parameterising the SEIRD model, and show later how a sensitivity analysis can be performed.</p>
<p>The SEIRD model has four transmission parameters: <span class="math inline">\(\beta\)</span>, <span class="math inline">\(\kappa\)</span>, <span class="math inline">\(\gamma\)</span> and <span class="math inline">\(\mu\)</span>. In what follows, we assume we are parameterising transmission of the ancestral SARS-CoV-2 strain (opposed to say, the Delta or Omicron variants).</p>
<p>We choose <span class="math inline">\(\kappa=1/5.5\)</span>, implicitly assuming an average latent period of 5.5 days <span class="citation">(Xin et al. 2021)</span>. We assume that 0.66% of individuals infected with the virus die <span class="citation">(Verity et al. 2020)</span>: this is termed an infection fatality ratio (IFR). Changing either <span class="math inline">\(\gamma\)</span> or <span class="math inline">\(\mu\)</span> affects both the rate at which individuals recover or die and the proportions which recover or die. As such, the implications of the individual parameter values are hard to intuit without recourse to the other. Here, we choose a different parameterisation that makes it simpler to set these parameters to appropriate values:</p>
<p><span class="math display">\[\begin{align}
\gamma &amp;= \zeta (1-\text{IFR})\\
\mu &amp;= \zeta \text{IFR}.
\end{align}\]</span></p>
<p>The proportion of infecteds who go on to die due to infection is given by the ratio of the rate of death to the overall rate out from the infectious compartment, which is the definition of the IFR:</p>
<p><span class="math display">\[\begin{equation}
\frac{\zeta \text{IFR}}{\zeta \text{IFR} + \zeta (1-\text{IFR})} = \text{IFR}.
\end{equation}\]</span></p>
<p>The average duration spent in the infectious compartment is given by:</p>
<p><span class="math display">\[\begin{equation}
\frac{1}{\zeta \text{IFR} + \zeta (1-\text{IFR})} = \frac{1}{\zeta}.
\end{equation}\]</span></p>
<p>Viral load data from hospitalised patients with known infector-infectee pairs can be used to determine the probability that infection occurs at a given time after the infector is first infected <span class="citation">(He et al. 2020)</span>: in so doing, determining a distribution representing the duration of infectiousness. In this model, there is no presymptomatic transmission and it has been estimated that viral loads decline quickly within 7 days of being symptomatic <span class="citation">(He et al. 2020)</span>. So, here, we assume an average infectious period of 7 days, resulting in <span class="math inline">\(\zeta=1/7\)</span>.</p>
<p>The remaining parameter, <span class="math inline">\(\beta\)</span>, is set to a value to produce the same basic reproduction number as was assumed in the influential “report 9” from Imperial College <span class="citation">(Ferguson et al. 2020)</span>: <span class="math inline">\(R_0=2.4\)</span> (see explanation of <span class="math inline">\(R_0\)</span> below).</p>
<p>All of the above parameter choices, which we regard as defaults for ancestral SARS-CoV-2 transmission are available through a convenience function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># convenience function</span>
<span class="va">parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/covid_transmission_parameters.html">covid_transmission_parameters</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">parameters</span><span class="op">)</span>
<span class="co">#&gt; $R0</span>
<span class="co">#&gt; [1] 2.4</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $kappa</span>
<span class="co">#&gt; [1] 0.1818182</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $gamma</span>
<span class="co">#&gt; [1] 0.1419143</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $mu</span>
<span class="co">#&gt; [1] 0.0009428571</span>

<span class="va">kappa</span> <span class="op">&lt;-</span> <span class="va">parameters</span><span class="op">$</span><span class="va">kappa</span>
<span class="va">gamma</span> <span class="op">&lt;-</span> <span class="va">parameters</span><span class="op">$</span><span class="va">gamma</span>
<span class="va">mu</span> <span class="op">&lt;-</span> <span class="va">parameters</span><span class="op">$</span><span class="va">mu</span>
<span class="va">R0_target</span> <span class="op">&lt;-</span> <span class="va">parameters</span><span class="op">$</span><span class="va">R0</span>
<span class="va">beta</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">mu</span> <span class="op">+</span> <span class="va">gamma</span><span class="op">)</span> <span class="op">*</span> <span class="va">R0_target</span>

<span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta<span class="op">=</span><span class="va">beta</span>, kappa<span class="op">=</span><span class="va">kappa</span>, gamma<span class="op">=</span><span class="va">gamma</span>, mu<span class="op">=</span><span class="va">mu</span><span class="op">)</span>
<span class="fu"><a href="../reference/transmission_parameters.html">transmission_parameters</a></span><span class="op">(</span><span class="va">my_model</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">params</span></code></pre></div>
<p>To check that the parameters have been set as desired, we can call:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/transmission_parameters.html">transmission_parameters</a></span><span class="op">(</span><span class="va">my_model</span><span class="op">)</span>
<span class="co">#&gt; $beta</span>
<span class="co">#&gt; [1] 0.3428571</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $kappa</span>
<span class="co">#&gt; [1] 0.1818182</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $gamma</span>
<span class="co">#&gt; [1] 0.1419143</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $mu</span>
<span class="co">#&gt; [1] 0.0009428571</span></code></pre></div>
<p>Note, that both overall and age-structured and “default” transmission parameters for other variants are also available through the same function. For example, the below outputs transmission parameters for an age-structured model for the Delta variant (see function documentation for more details).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/covid_transmission_parameters.html">covid_transmission_parameters</a></span><span class="op">(</span>
  variant <span class="op">=</span> <span class="st">"delta"</span>,
  is_age_structured <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># here mu is age structured</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">parameters</span><span class="op">$</span><span class="va">mu</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 9 × 3</span></span>
<span class="co">#&gt;   age_lower age_upper         mu</span>
<span class="co">#&gt;       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>         0         9 0.000<span style="text-decoration: underline;">002</span>29</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>        10        19 0.000<span style="text-decoration: underline;">01</span>   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>        20        29 0.000<span style="text-decoration: underline;">044</span>3 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span>        30        39 0.000<span style="text-decoration: underline;">371</span>  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span>        40        49 0.000<span style="text-decoration: underline;">686</span>  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span>        50        59 0.000<span style="text-decoration: underline;">857</span>  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">7</span>        60        69 0.002<span style="text-decoration: underline;">71</span>   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">8</span>        70        79 0.006<span style="text-decoration: underline;">14</span>   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">9</span>        80       150 0.011<span style="text-decoration: underline;">1</span></span></code></pre></div>
<p>An additional set of parameters dictate the initial conditions of the system. Since SARS-CoV-2 is a novel virus, at the very beginning of the pandemic, everyone was susceptible. Here, we imagine a small number of infectious individuals entered a new population, at the start, representing 0.0001% of the population.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">I0</span> <span class="op">&lt;-</span> <span class="fl">1e-6</span>
<span class="va">inits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>S0<span class="op">=</span><span class="fl">1</span><span class="op">-</span><span class="va">I0</span>, E0<span class="op">=</span><span class="fl">0</span>, I0<span class="op">=</span><span class="va">I0</span>, R0<span class="op">=</span><span class="fl">0</span><span class="op">)</span>
<span class="fu"><a href="../reference/initial_conditions.html">initial_conditions</a></span><span class="op">(</span><span class="va">my_model</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">inits</span></code></pre></div>
<p>Now we simulate the system for one year.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">365</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">out_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span><span class="va">my_model</span>, <span class="va">times</span><span class="op">)</span></code></pre></div>
<p>The simulation returns two objects: one is a data frame comprising the states over time. Here, we see that, over time, the proportion of susceptible individuals declines over time as the infection penetrates through the population. Initially, there are relatively few infected individuals but this then grows, reaching and then declining when there are relatively few susceptibles left. The number of recovered and dead individuals also grows over time.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">states</span> <span class="op">&lt;-</span> <span class="va">out_df</span><span class="op">$</span><span class="va">states</span>

<span class="fu">ggplot</span><span class="op">(</span><span class="va">states</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">compartment</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_color_brewer</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"time (days)"</span>, y <span class="op">=</span> <span class="st">"value of each compartment"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>, legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,
        text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="SEIRD_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
<p>The simulation also outputs daily case incidence and deaths. These are derived from the state variables. Incidence is just the difference between the cumulative number of cases between two time points,</p>
<p><span class="math display">\[ \text{incidence(t)} = C(t) - C(t - 1),\]</span></p>
<p>since this shows the number of cases which have arisen between these time points. Deaths are also given by a difference, but, in this instance, between the cumulative number of deaths at two consecutive time points:</p>
<p><span class="math display">\[ \text{deaths(t)} = D(t) - D(t - 1).\]</span></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">changes</span> <span class="op">&lt;-</span> <span class="va">out_df</span><span class="op">$</span><span class="va">changes</span>

<span class="fu">ggplot</span><span class="op">(</span><span class="va">changes</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">value</span> <span class="op">*</span> <span class="fl">1000</span>, fill <span class="op">=</span> <span class="va">compartment</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_bar</span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span>, position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"time (days)"</span>, y <span class="op">=</span> <span class="st">"rate per 1000 of the \n population per day"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>, legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,
        text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_fill_brewer</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span></code></pre></div>
<p><img src="SEIRD_files/figure-html/fig2-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="sensitivity-analysis">Sensitivity analysis<a class="anchor" aria-label="anchor" href="#sensitivity-analysis"></a>
</h2>
<p>The SEIRD has four transmission parameters which influence the type of dynamics resultant by the system. In epidemiological systems, these parameters are not known and are set either by fitting the model to data or from external studies. As such, assessing the sensitivity of the model’s outputs to the input parameters is crucial.</p>
<p>In this section, we first investigate the sensitivity of the number of deaths to the transmission rate, <span class="math inline">\(\beta\)</span>. To do so, we run the model across a range of different <span class="math inline">\(\beta\)</span> values and plot the proportions infectious.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/covid_transmission_parameters.html">covid_transmission_parameters</a></span><span class="op">(</span><span class="op">)</span>


<span class="co"># function to setup and run model for different beta values</span>
<span class="va">run_seird</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">beta_val</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta<span class="op">=</span><span class="va">beta_val</span>,
                 kappa<span class="op">=</span><span class="va">parameters</span><span class="op">$</span><span class="va">kappa</span>,
                 gamma<span class="op">=</span><span class="va">parameters</span><span class="op">$</span><span class="va">gamma</span>,
                 mu<span class="op">=</span><span class="va">parameters</span><span class="op">$</span><span class="va">mu</span><span class="op">)</span>
  <span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SEIRD-class.html">SEIRD</a></span><span class="op">(</span>initial_conditions <span class="op">=</span> <span class="va">inits</span>,
                transmission_parameters<span class="op">=</span><span class="va">params</span><span class="op">)</span>
  <span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">365</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>
  <span class="va">out_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">times</span><span class="op">)</span>
  <span class="va">out_df</span><span class="op">$</span><span class="va">states</span>
<span class="op">}</span>

<span class="co"># run model across different beta values</span>
<span class="va">beta_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">beta_vals</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">beta_temp</span> <span class="op">&lt;-</span> <span class="va">beta_vals</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu">run_seird</span><span class="op">(</span><span class="va">beta_temp</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>beta<span class="op">=</span><span class="va">beta_temp</span><span class="op">)</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>
    <span class="va">result</span> <span class="op">&lt;-</span> <span class="va">temp</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>beta<span class="op">=</span><span class="va">beta_temp</span><span class="op">)</span>
  <span class="kw">else</span>
    <span class="va">result</span> <span class="op">&lt;-</span> <span class="va">result</span> <span class="op">%&gt;%</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># plot results</span>
<span class="va">result</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">compartment</span><span class="op">==</span><span class="st">"I"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">time</span>, y<span class="op">=</span><span class="va">value</span>, colour <span class="op">=</span> <span class="va">beta</span>, group<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_color_viridis_c</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"time (days)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Infectious proportion"</span><span class="op">)</span></code></pre></div>
<p><img src="SEIRD_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<p>Why do some of the simulations produce epidemic waves whereas others fail to do so?</p>
<p>This is can be explored through the basic reproductive number, <span class="math inline">\(R_0\)</span>, which is the expected number of people infected by a single infectious individual in a population where everyone is susceptible. (Note that this basic reproductive number is unrelated to the initial condition for the recovered population.)</p>
<p>If <span class="math inline">\(R_0&gt;1\)</span>, an infectious individual infects more than one other person and the epidemic initially grows exponentially; if <span class="math inline">\(R_0&lt;1\)</span>, an infectious individual infects less than one other person and the epidemic fails to materialise.</p>
<p>But how can we calculate the <span class="math inline">\(R_0\)</span> value? In a fully susceptible population, <span class="math inline">\(S=1\)</span>, meaning that the number of newly infected individuals produced per unit time is <span class="math inline">\(\beta I\)</span>. So the number of new infections produced for a single infectious individual is <span class="math inline">\(\beta\)</span> per unit time. To determine the number of new infections that a single individual produces on average, we then need to know the typical duration of infectiousness. Once an individual becomes infectious, there are two mechanisms by which they stop being so: either they recover or they die. The overall rate at which these occur is <span class="math inline">\(\gamma + \mu\)</span>, so the average period an individual spends in the infectious state is <span class="math inline">\(1/(\gamma + \mu)\)</span>. So, the number of new infections produced by an infected individual is:</p>
<p><span class="math display">\[R_0 = \text{new infections per unit time} \times \text{duration of infectiousness} = \beta /(\gamma + \mu).\]</span></p>
<p>We can now calculate <span class="math inline">\(R_0\)</span> for each of the curves using the inbuilt function in <code>comomodels</code>. We then colour the curves according to this value; we also make the type of line drawn depend on whether <span class="math inline">\(R_0&gt;1\)</span>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># convenience function to determine R_0</span>
<span class="va">find_R0</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">beta_val</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">params</span> <span class="op">&lt;-</span> <span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta<span class="op">=</span><span class="va">beta_val</span>,
                 kappa<span class="op">=</span><span class="va">parameters</span><span class="op">$</span><span class="va">kappa</span>,
                 gamma<span class="op">=</span><span class="va">parameters</span><span class="op">$</span><span class="va">gamma</span>,
                 mu<span class="op">=</span><span class="va">parameters</span><span class="op">$</span><span class="va">mu</span><span class="op">)</span>
  <span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SEIRD-class.html">SEIRD</a></span><span class="op">(</span>initial_conditions <span class="op">=</span> <span class="va">inits</span>,
                transmission_parameters<span class="op">=</span><span class="va">params</span><span class="op">)</span>
  <span class="fu"><a href="../reference/R0.html">R0</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># calculate R_0 values</span>
<span class="va">R0_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">beta_vals</span><span class="op">)</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">beta_vals</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">R0_vals</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">find_R0</span><span class="op">(</span><span class="va">beta_vals</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># create lookup</span>
<span class="va">lookup</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>beta<span class="op">=</span><span class="va">beta_vals</span>,
                 R0<span class="op">=</span><span class="va">R0_vals</span><span class="op">)</span>

<span class="co"># merge with results</span>
<span class="va">result</span> <span class="op">&lt;-</span> <span class="va">result</span> <span class="op">%&gt;%</span> 
  <span class="fu">left_join</span><span class="op">(</span><span class="va">lookup</span><span class="op">)</span>
<span class="co">#&gt; Joining, by = "beta"</span>

<span class="co"># plot by R0</span>
<span class="va">result</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>R0_above<span class="op">=</span><span class="va">R0</span><span class="op">&gt;</span><span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">compartment</span><span class="op">==</span><span class="st">"I"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">time</span>, y<span class="op">=</span><span class="va">value</span>, colour <span class="op">=</span> <span class="va">R0</span>, group<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype<span class="op">=</span><span class="va">R0_above</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_color_viridis_c</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_linetype</span><span class="op">(</span><span class="st">"R0&gt;1"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"time (days)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Infectious proportion"</span><span class="op">)</span></code></pre></div>
<p><img src="SEIRD_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<p>From this, it is evident that <span class="math inline">\(R_0&gt;1\)</span> is required for an epidemic to arise. As such, we see the importance of <span class="math inline">\(R_0\)</span> for dictating whether or not a pathogen successfully invades a population.</p>
</div>
<div class="section level2">
<h2 id="effective-reproduction-number">Effective reproduction number<a class="anchor" aria-label="anchor" href="#effective-reproduction-number"></a>
</h2>
<p>Throughout the course of an epidemic, the fraction who are susceptible to infection fluctuates over time. As such, the average number of secondary infections produced by a single infected individual changes. This can be quantified by the effective reproduction number, <span class="math inline">\(R_t\)</span>, which represents the average number of new infections caused by an infected individual at time <span class="math inline">\(t\)</span>. To obtain <span class="math inline">\(R_t\)</span>, we simply multiply <span class="math inline">\(R_0\)</span> by the fraction of the population susceptible:</p>
<p><span class="math display">\[R_t = R_0 * S(t) = \beta S(t) /(\gamma + \mu).\]</span></p>
<p>We can plot <span class="math inline">\(R_t\)</span> over time for the initial simulations performed. We also show the proportion infectious over time (scaled up by a proportion to make the peak clearly visible).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># calculate Rt</span>
<span class="va">R0_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/R0.html">R0</a></span><span class="op">(</span><span class="va">my_model</span><span class="op">)</span>
<span class="va">s_df</span> <span class="op">&lt;-</span> <span class="va">states</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">compartment</span><span class="op">==</span><span class="st">"S"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>value<span class="op">=</span><span class="va">value</span> <span class="op">*</span> <span class="va">R0_val</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>compartment<span class="op">=</span><span class="st">"Rt"</span><span class="op">)</span>

<span class="co"># plot: blowing up I value so that peak is visible</span>
<span class="va">states</span> <span class="op">%&gt;%</span> 
  <span class="fu">bind_rows</span><span class="op">(</span><span class="va">s_df</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>value<span class="op">=</span><span class="fu">if_else</span><span class="op">(</span><span class="va">compartment</span><span class="op">==</span><span class="st">"I"</span>, <span class="fl">10</span> <span class="op">*</span> <span class="va">value</span>, <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">compartment</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rt"</span>, <span class="st">"I"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">1</span>, linetype<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">compartment</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_color_brewer</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"time (days)"</span>, y <span class="op">=</span> <span class="st">"value of each compartment"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>, legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,
        text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="SEIRD_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
<p>Here, we see that as <span class="math inline">\(R_t\rightarrow 1\)</span>, we reach so-called “herd immunity”, and there are no longer sufficient susceptibles in the population to fuel continued epidemic growth. This occurs when <span class="math inline">\(R_t&lt;1\)</span>, which indicates:</p>
<p><span class="math display">\[\begin{equation}
S(t) &lt; \frac{1}{R_0}.
\end{equation}\]</span></p>
<p>The critical proportion of the population that need to have been exposed to the virus to achieve herd immunity is then:</p>
<p><span class="math display">\[\begin{equation}
R^* = 1 - \frac{1}{R_0}.
\end{equation}\]</span></p>
<p>When a fraction exceeding <span class="math inline">\(R^*\)</span> have been exposed, the immunity of those who have recovered from the virus effectively protects those who haven’t.</p>
</div>
<div class="section level2 unnumbered">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references">
<div id="ref-anderson1992infectious">
<p>Anderson, Roy M, and Robert M May. 1992. <em>Infectious Diseases of Humans: Dynamics and Control</em>. Oxford university press.</p>
</div>
<div id="ref-erban2007practical">
<p>Erban, Radek, Jonathan Chapman, and Philip Maini. 2007. “A Practical Guide to Stochastic Simulations of Reaction-Diffusion Processes.” <em>arXiv Preprint arXiv:0704.1908</em>.</p>
</div>
<div id="ref-ferguson2020report">
<p>Ferguson, Neil, Daniel Laydon, Gemma Nedjati Gilani, Natsuko Imai, Kylie Ainslie, Marc Baguelin, Sangeeta Bhatia, et al. 2020. “Report 9: Impact of Non-Pharmaceutical Interventions (Npis) to Reduce Covid19 Mortality and Healthcare Demand.”</p>
</div>
<div id="ref-he2020temporal">
<p>He, Xi, Eric HY Lau, Peng Wu, Xilong Deng, Jian Wang, Xinxin Hao, Yiu Chung Lau, et al. 2020. “Temporal Dynamics in Viral Shedding and Transmissibility of Covid-19.” <em>Nature Medicine</em> 26 (5): 672–75.</p>
</div>
<div id="ref-petzold1983automatic">
<p>Petzold, Linda. 1983. “Automatic Selection of Methods for Solving Stiff and Nonstiff Systems of Ordinary Differential Equations.” <em>SIAM Journal on Scientific and Statistical Computing</em> 4 (1): 136–48.</p>
</div>
<div id="ref-desolve">
<p>Soetaert, Karline, Thomas Petzoldt, and R. Woodrow Setzer. 2010. “Solving Differential Equations in R: Package deSolve.” <em>Journal of Statistical Software</em> 33 (9): 1–25. <a href="https://doi.org/10.18637/jss.v033.i09" class="external-link">https://doi.org/10.18637/jss.v033.i09</a>.</p>
</div>
<div id="ref-verity2020estimates">
<p>Verity, Robert, Lucy C Okell, Ilaria Dorigatti, Peter Winskill, Charles Whittaker, Natsuko Imai, Gina Cuomo-Dannenburg, et al. 2020. “Estimates of the Severity of Coronavirus Disease 2019: A Model-Based Analysis.” <em>The Lancet Infectious Diseases</em> 20 (6): 669–77.</p>
</div>
<div id="ref-Xin21">
<p>Xin, Hualei, Yu Li, Peng Wu, Zhili Li, Eric H Y Lau, Ying Qin, Liping Wang, Benjamin J Cowling, Tim K Tsang, and Zhongjie Li. 2021. “Estimating the Latent Period of Coronavirus Disease 2019 (COVID-19).” <em>Clinical Infectious Diseases</em>, September. <a href="https://doi.org/10.1093/cid/ciab746" class="external-link">https://doi.org/10.1093/cid/ciab746</a>.</p>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by The Como-DTC Development Team.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
