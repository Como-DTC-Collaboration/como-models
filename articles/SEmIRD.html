<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="comomodels">
<title>Multiple exposed compartments model • comomodels</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multiple exposed compartments model">
<meta property="og:description" content="comomodels">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">comomodels</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/SEIRD_age_structured.html">Age-structured model</a>
    <a class="dropdown-item" href="../articles/SEIaImIsRD.html">Asymptomatic, mild and severe symptom compartment model</a>
    <a class="dropdown-item" href="../articles/SEIRD_BD.html">Births and natural deaths and waning natural immunity</a>
    <a class="dropdown-item" href="../articles/SEmIRD.html">Multiple exposed compartments model</a>
    <a class="dropdown-item" href="../articles/SEIRDNPIAge.html">NPIs: age-structured model</a>
    <a class="dropdown-item" href="../articles/SEIRD_CT.html">NPIs: contact tracing and quarantining</a>
    <a class="dropdown-item" href="../articles/SEIRD.html">SEIRD model</a>
    <a class="dropdown-item" href="../articles/SEIRDV.html">Vaccinations model</a>
    <a class="dropdown-item" href="../articles/SEIRDVAge.html">Vaccinations: age-structured model</a>
    <a class="dropdown-item" href="../articles/SEIRD_rural_urban.html">Urban and rural metapopulations model</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">
<script src="SEmIRD_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Multiple exposed compartments model</h1>
                        <h4 data-toc-skip class="author">Ben Lambert and Liangti Dai</h4>
            
      
      
      <div class="d-none name"><code>SEmIRD.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette introduces the <code>SEmIRD</code> model. This model is an extension of the <a href="https://github.com/Como-DTC-Collaboration/como-models/blob/main/vignettes/SEIRD.Rmd" class="external-link">SEIRD model</a>, which is described by the following ODEs:</p>
<p><span class="math display">\[\frac{\text{d}S}{\text{d}t} = -\beta S I,\]</span> <span class="math display">\[\frac{\text{d}E}{\text{d}t} = \beta S I -\kappa E,\]</span> <span class="math display">\[\frac{\text{d}I}{\text{d}t} =\kappa E - (\gamma + \mu) I,\]</span> <span class="math display">\[\frac{\text{d}R}{\text{d}t} = \gamma I,\]</span> <span class="math display">\[\frac{\text{d}D}{\text{d}t} = \mu I.\]</span> In this vignette, we are going to focus on the time period that individuals spend, on average, in the exposed compartment. This time period is known as the latent period.</p>
<p>We can gain insight into how the flow out of the <span class="math inline">\(E\)</span> compartment works by imagining that we exhaust the infected individuals at a given time: <span class="math inline">\(t=0\)</span>. The new equation then becomes:</p>
<p><span class="math display">\[\frac{\text{d}E}{\text{d}t} = -\kappa E,\]</span> Supposing there is a given number of infected individuals at <span class="math inline">\(t=0\)</span> represented by <span class="math inline">\(E=E_0\)</span>, we can solve the above equation to yield an expression for the number of exposed over time:</p>
<p><span class="math display">\[E(t) = E_0 \exp (- \kappa t)\]</span> representing exponential decay, which we can plot assuming <span class="math inline">\(E_0=1\)</span> and <span class="math inline">\(\kappa=0.5\)</span>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">comomodels</span><span class="op">)</span>

<span class="co"># function to return exponential decay</span>
<span class="va">E</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">E_0</span>, <span class="va">kappa</span>, <span class="va">t</span><span class="op">)</span> <span class="op">{</span><span class="va">E_0</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">kappa</span> <span class="op">*</span> <span class="va">t</span><span class="op">)</span><span class="op">}</span>

<span class="co"># make values to plot</span>
<span class="va">E_0</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">kappa</span> <span class="op">&lt;-</span> <span class="fl">0.5</span>
<span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">0.01</span><span class="op">)</span>
<span class="va">E_vals</span> <span class="op">&lt;-</span> <span class="fu">E</span><span class="op">(</span><span class="va">E_0</span>, <span class="va">kappa</span>, <span class="va">t</span><span class="op">)</span>

<span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>t<span class="op">=</span><span class="va">t</span>, E<span class="op">=</span><span class="va">E_vals</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">t</span>, y<span class="op">=</span><span class="va">E</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"time (days)"</span><span class="op">)</span></code></pre></div>
<p><img src="SEmIRD_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
<p>We can also show the effect of changing <span class="math inline">\(\kappa\)</span>: unsurprisingly, as <span class="math inline">\(\kappa\)</span> increases, the rate at which individuals become infectious increases and there is faster decay.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">kappa_1</span> <span class="op">&lt;-</span> <span class="fl">0.5</span>
<span class="va">kappa_2</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">kappa_3</span> <span class="op">&lt;-</span> <span class="fl">2</span>
<span class="va">E_1</span> <span class="op">&lt;-</span> <span class="fu">E</span><span class="op">(</span><span class="va">E_0</span>, kappa<span class="op">=</span><span class="va">kappa_1</span>, t<span class="op">=</span><span class="va">t</span><span class="op">)</span>
<span class="va">E_2</span> <span class="op">&lt;-</span> <span class="fu">E</span><span class="op">(</span><span class="va">E_0</span>, kappa<span class="op">=</span><span class="va">kappa_2</span>, t<span class="op">=</span><span class="va">t</span><span class="op">)</span>
<span class="va">E_3</span> <span class="op">&lt;-</span> <span class="fu">E</span><span class="op">(</span><span class="va">E_0</span>, kappa<span class="op">=</span><span class="va">kappa_3</span>, t<span class="op">=</span><span class="va">t</span><span class="op">)</span>
<span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="va">t</span>, E<span class="op">=</span><span class="va">E_1</span>, kappa<span class="op">=</span><span class="va">kappa_1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="va">t</span>, E<span class="op">=</span><span class="va">E_2</span>, kappa<span class="op">=</span><span class="va">kappa_2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="va">t</span>, E<span class="op">=</span><span class="va">E_3</span>, kappa<span class="op">=</span><span class="va">kappa_3</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">t</span>, y<span class="op">=</span><span class="va">E</span>, colour<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">kappa</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span><span class="st">"kappa"</span>, palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"time (days)"</span><span class="op">)</span></code></pre></div>
<p><img src="SEmIRD_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="stochastic-models-and-their-means">Stochastic models and their means<a class="anchor" aria-label="anchor" href="#stochastic-models-and-their-means"></a>
</h2>
<p>An alternative way to view these exponential decay curves is as probability distributions governing the time taken for an exposed individual to become infectious: i.e. the duration of the latent period.</p>
<p>In our ODE, we treat the population as a continuum, and there is thus no concept of a single discrete individual. It is, however, possible to formulate discrete stochastic versions of this model which consider individual dynamics using a reaction-equation type model. Considering again the ODE:</p>
<p><span class="math display">\[\frac{\text{d}E}{\text{d}t} = -\kappa E,\]</span> with initial condition <span class="math inline">\(E(0) = E_0\)</span>. We can create a stochastic model which is analogue to this, where the probability that a particular exposed individual becomes infectious in time period <span class="math inline">\(\delta t\)</span> is given by <span class="math inline">\(\kappa \delta t\)</span>. We now follow <span class="citation">Erban, Chapman, and Maini (2007)</span> to illustrate that the mean of this stochastic process is the same as the solution of the above ODE.</p>
<p>We let <span class="math inline">\(p_E(t)\)</span> denote the probability that there are <span class="math inline">\(E\)</span> exposed individuals at time <span class="math inline">\(t\)</span>. We suppose that <span class="math inline">\(\delta t\)</span> is so small that the probability that two exposed individuals become infectious in the period <span class="math inline">\([t,t+\delta t)\)</span> is negligible. There are two ways for there to be <span class="math inline">\(E\)</span> exposed individuals at time <span class="math inline">\(t+\delta t\)</span>: either there were <span class="math inline">\(E\)</span> individuals at time <span class="math inline">\(t\)</span> and no individual became infectious in this period with probability <span class="math inline">\((1-\kappa E \delta t)\)</span>; or there were <span class="math inline">\(E+1\)</span> individuals at time <span class="math inline">\(t\)</span> and one individual became infectious with probability <span class="math inline">\(\kappa (E+1) \delta t\)</span>. Therefore:</p>
<p><span class="math display">\[\begin{equation}
p_E(t+\delta t) = p_E(t) (1-\kappa E \delta t) + p_{E+1}(t) \kappa (E+1) \delta t,
\end{equation}\]</span></p>
<p>which can be rearranged to:</p>
<p><span class="math display">\[\begin{equation}
\frac{p_E(t+\delta t) - p_E(t)}{\delta t} = \kappa(E+1)p_{E+1}(t) - \kappa E p_E(t),
\end{equation}\]</span></p>
<p>taking the limit as <span class="math inline">\(\delta t\rightarrow 0\)</span>, we obtain the so-called “chemical master equation” for the system:</p>
<p><span class="math display">\[\begin{equation}
\frac{\text{d}p_E}{\text{d}t} = \kappa(E+1)p_{E+1} - \kappa E p_E.
\end{equation}\]</span></p>
<p>This equation holds for <span class="math inline">\(E=0,1,2,...,E_0-1\)</span>. Considering <span class="math inline">\(E=E_0\)</span>, there is only one way for this to occur, which is if no exposed individual became infectious during this period so, we obtain an equation:</p>
<p><span class="math display">\[\begin{equation}
\frac{\text{d}p_{E_0}}{\text{d}t} = -\kappa E_0 p_{E_0},
\end{equation}\]</span></p>
<p>which has solution <span class="math inline">\(p_{E_0}(t) = \exp (-\kappa E_0 t)\)</span>.</p>
<p>(So, considering a system of a single exposed individual, the probability they remain exposed is given by an exponential distribution with rate parameter <span class="math inline">\(\kappa\)</span> meaning the average duration of their latent period is <span class="math inline">\(1/\kappa\)</span>.)</p>
<p>The equation for <span class="math inline">\(E_0\)</span> above can then be used to solve the equation for <span class="math inline">\(p_{E_0-1}(t)\)</span> and iteratively (see <span class="citation">Erban, Chapman, and Maini (2007)</span> section 2.1), this leads to a solution for any integer <span class="math inline">\(0\leq E \leq E_0\)</span>:</p>
<p><span class="math display">\[\begin{equation}
p_E(t) = \exp(-\kappa E t) \binom{E_0}{E} (1 - \exp(-\kappa t))^{E_0-E}.
\end{equation}\]</span></p>
<p>The mean number of exposed individuals at time <span class="math inline">\(t\)</span> is then given by:</p>
<p><span class="math display">\[\begin{align}
\bar{E}(t) &amp;= \sum_{E=0}^{E_0} E p_E(t)\\
&amp;= \sum_{E=0}^{E_0} E \exp(-\kappa E t) \binom{E_0}{E} (1 - \exp(-\kappa t))^{E_0-E}\\
&amp;= E_0 \exp(-\kappa t) \sum_{E=1}^{E_0} \exp(-\kappa (E-1) t) \binom{E_0-1}{E-1} (1 - \exp(-\kappa t))^{(E_0-1)-(E-1)}\\
&amp;= E_0 \exp(-\kappa t),
\end{align}\]</span></p>
<p>where the third line is obtained by using <span class="math inline">\(\binom{E_0}{E} = \frac{E_0}{E}\binom{E_0-1}{E-1}\)</span>; the last line is obtained since the sum extends over all possible values of <span class="math inline">\(E\)</span> for a distribution starting at <span class="math inline">\(E_0-1\)</span>, which must equal 1.</p>
<p>The most notable aspect of <span class="math inline">\(\bar{E}(t)\)</span> is that it matches the solution of the deterministic system. This shows that, for this system, there is an equivalence between the deterministic model and the stochastic model, where the former is a mean-field solution of the latter. This is nice because it allows us to ascribe “individual meaning” to parameters in the ODE: here, <span class="math inline">\(1/\kappa\)</span> is the mean duration spent in the infected state for an analogous stochastic model.</p>
</div>
<div class="section level2">
<h2 id="the-latent-period-for-covid-19">The latent period for COVID-19<a class="anchor" aria-label="anchor" href="#the-latent-period-for-covid-19"></a>
</h2>
<p>But what does the distribution governing the latent period actually look like? Using repeatedly sampled PCR test data from close contacts of confirmed cases in mainland China, a recent study estimated the latent period of COVID-19 as 5.5 days and a log-normal probability distribution was found to represent that waiting period <span class="citation">(Xin et al. 2021)</span>. Below we compare the waiting period for the log-normal distribution fit in <span class="citation">Xin et al. (2021)</span> with an exponential distribution with the same latent period.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># values derived from Xi et al., Table S2 </span>
<span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">1.61</span>
<span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">0.44</span>

<span class="co"># equivalent decay for exponential model</span>
<span class="va">kappa</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">5.5</span>

<span class="co"># generate densities across rate of time</span>
<span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">0.01</span><span class="op">)</span>
<span class="va">lnorm_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">dlnorm</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">mu</span>, <span class="va">sigma</span><span class="op">)</span>
<span class="va">exp_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">dexp</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">kappa</span><span class="op">)</span>

<span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="va">t</span>, value<span class="op">=</span><span class="va">lnorm_vals</span>, model<span class="op">=</span><span class="st">"log-normal"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="va">t</span>, value<span class="op">=</span><span class="va">exp_vals</span>, model<span class="op">=</span><span class="st">"exponential"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">t</span>, y<span class="op">=</span><span class="va">value</span>, colour<span class="op">=</span><span class="va">model</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span><span class="st">"Model"</span>, palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"density"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"time (days)"</span><span class="op">)</span></code></pre></div>
<p><img src="SEmIRD_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<p>Although these share a common mean waiting period, there are considerable differences between the curves. An alternative way to view this is through the cumulative distribution functions:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lnorm_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">plnorm</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">mu</span>, <span class="va">sigma</span><span class="op">)</span>
<span class="va">exp_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">pexp</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">kappa</span><span class="op">)</span>

<span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="va">t</span>, value<span class="op">=</span><span class="va">lnorm_vals</span>, model<span class="op">=</span><span class="st">"log-normal"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="va">t</span>, value<span class="op">=</span><span class="va">exp_vals</span>, model<span class="op">=</span><span class="st">"exponential"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">t</span>, y<span class="op">=</span><span class="va">value</span>, colour<span class="op">=</span><span class="va">model</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span><span class="st">"Model"</span>, palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"cumulative density"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"time (days)"</span><span class="op">)</span></code></pre></div>
<p><img src="SEmIRD_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<p>These cumulative distribution functions show substantial differences. For example, the exponential curve predicts that approximately 37% individuals will have become infectious after 2.5 days versus 6% for the log-normal one.</p>
</div>
<div class="section level2">
<h2 id="the-semird-model">The SEmIRD model<a class="anchor" aria-label="anchor" href="#the-semird-model"></a>
</h2>
<p>To allow a non-exponential waiting period, a number of modelling approaches are possible and include a range of stochastic models, for instance renewal-type models and individual-based models. It is, however, possible to allow a Erlang-distributed waiting time<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;An Erlang distribution is a gamma distribution with an integer shape parameter.&lt;/p&gt;"><sup>1</sup></a> in the stochastic analogue of an ODE model by splitting a stage into several substages. This is known as the “linear chain trick” (see <span class="citation">Hurtado and Kirosingh (2019)</span>).</p>
<p>In the <code>SEmIRD</code> model, we split the exposed compartment into <span class="math inline">\(n\)</span> substages: <span class="math inline">\(E_1, E_2, ..., E_n\)</span>. The ODEs describing the dynamics are hence:</p>
<p><span class="math display">\[\frac{\text{d}S}{\text{d}t} = -\beta S I,\]</span> <span class="math display">\[\frac{\text{d}E_i}{\text{d}t} = \begin{cases}
                                    \beta S I -\kappa E_i,      &amp; \text{if } i = 1\\
                                    \kappa E_{i-1} -\kappa E_i, &amp; \text{otherwise}
                                  \end{cases}\]</span></p>
<p><span class="math display">\[\frac{\text{d}I}{\text{d}t} =\kappa E_n - (\gamma + \mu) I,\]</span> <span class="math display">\[\frac{\text{d}R}{\text{d}t} = \gamma I,\]</span> <span class="math display">\[\frac{\text{d}D}{\text{d}t} = \mu I.\]</span> Thus a newly exposed individual (entering <span class="math inline">\(E_1\)</span>) only becomes infectious (entering <span class="math inline">\(I\)</span>) after they have passed through a host of intermediate states: <span class="math inline">\(E_1\rightarrow E_2 ...\rightarrow E_{n-1} \rightarrow E_n\)</span>. In the stochastic analogue of this ODE system, the average time taken to go from <span class="math inline">\(E_1\rightarrow I\)</span> is given by a <span class="math inline">\(\text{Erlang}(n,\kappa)\)</span> distribution, which has a mean of <span class="math inline">\(n/\kappa\)</span>. Thus to match the same mean as the exponential distribution we need to multiply <span class="math inline">\(\kappa\)</span> by n.</p>
</div>
<div class="section level2">
<h2 id="comparing-the-semird-and-seird-models">Comparing the SEmIRD and SEIRD models<a class="anchor" aria-label="anchor" href="#comparing-the-semird-and-seird-models"></a>
</h2>
<p>We now compare how this model with <span class="math inline">\(n=5\)</span> behaves versus the SEIRD. In both cases, we assume that, at <span class="math inline">\(t=0\)</span>, all individuals are in the first exposed compartment (note, for the SEIRD model, the first exposed compartment is the only exposed compartment). To make the differences stark, we assume that the average latent period lasts 20 days. For the other parameters, we use the same set as were used in the SEIRD model vignette.</p>
<p>We first simulate the SEIRD model and plot the exposed and infectious compartments. In this plot, the fraction of infectious individuals grows at a fast rate right from the start and peaks somewhere near <span class="math inline">\(t=5\)</span> days.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># parameterise model</span>
<span class="va">kappa</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">20</span>
<span class="va">IFR</span> <span class="op">&lt;-</span> <span class="fl">0.0066</span>
<span class="va">zeta</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">2</span>
<span class="va">gamma</span> <span class="op">&lt;-</span> <span class="va">zeta</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">IFR</span><span class="op">)</span>
<span class="va">mu</span> <span class="op">&lt;-</span> <span class="va">zeta</span> <span class="op">*</span> <span class="va">IFR</span>
<span class="va">R0_target</span> <span class="op">&lt;-</span> <span class="fl">2.4</span>
<span class="va">beta</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">mu</span> <span class="op">+</span> <span class="va">gamma</span><span class="op">)</span> <span class="op">*</span> <span class="va">R0_target</span>

<span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SEIRD-class.html">SEIRD</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta<span class="op">=</span><span class="va">beta</span>, kappa<span class="op">=</span><span class="va">kappa</span>, gamma<span class="op">=</span><span class="va">gamma</span>, mu<span class="op">=</span><span class="va">mu</span><span class="op">)</span>
<span class="fu"><a href="../reference/transmission_parameters.html">transmission_parameters</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">params</span>
<span class="fu"><a href="../reference/initial_conditions.html">initial_conditions</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>S0<span class="op">=</span><span class="fl">0</span>, E0<span class="op">=</span><span class="fl">1</span>, I0<span class="op">=</span><span class="fl">0</span>, R0<span class="op">=</span><span class="fl">0</span><span class="op">)</span>

<span class="co"># run model</span>
<span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span>, <span class="fl">0.1</span><span class="op">)</span>
<span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">times</span><span class="op">)</span>
<span class="va">states</span> <span class="op">&lt;-</span> <span class="va">output</span><span class="op">$</span><span class="va">states</span>

<span class="co"># plot results</span>
<span class="va">states</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">compartment</span>, <span class="st">"E|I"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">time</span>, y<span class="op">=</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour<span class="op">=</span><span class="va">compartment</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"time (days)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"fraction of the population"</span><span class="op">)</span></code></pre></div>
<p><img src="SEmIRD_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<p>We now repeat this exercise with the SEmIRD model. To ensure that we have the same mean duration of the latent period, we set <span class="math inline">\(\kappa_s=5\kappa\)</span>, where <span class="math inline">\(\kappa_s\)</span> is the transit rate out of each of the <span class="math inline">\(E_i\)</span> compartments in the SEmIRD model.</p>
<p>We initialise the values for the <span class="math inline">\(E_i\)</span> compartments as a list of values, in which the size of the list will be taken as the number of exposed compartments (<span class="math inline">\(n\)</span>), whose order corresponds to <span class="math inline">\(E_1\)</span>, <span class="math inline">\(E_2\)</span>, …, <span class="math inline">\(E_n\)</span>.</p>
<p>In a model with <span class="math inline">\(n=5\)</span> exposed compartments, the plot of the exposed and infectious compartments shows the decline of initial exposed state (<span class="math inline">\(E_1\)</span>) and the rise and fall of the intermediate states (<span class="math inline">\(E_2\)</span> through <span class="math inline">\(E_5\)</span>). This procession of intermediate states through which individuals must pass to become infectious means that the infectious state fraction rises much later than for the SEIRD model: here, it peaks much nearer <span class="math inline">\(t=20\)</span> days. Effectively, allowing multiple exposed compartments induces a sort of delay between individuals becoming exposed and then transitioning to infected.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SEmIRD-class.html">SEmIRD</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># change parameters</span>
<span class="va">kappa_s</span> <span class="op">&lt;-</span> <span class="va">kappa</span> <span class="op">*</span> <span class="fl">5</span>
<span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta<span class="op">=</span><span class="va">beta</span>, kappa<span class="op">=</span><span class="va">kappa_s</span>, gamma<span class="op">=</span><span class="va">gamma</span>, mu<span class="op">=</span><span class="va">mu</span><span class="op">)</span>
<span class="fu"><a href="../reference/transmission_parameters.html">transmission_parameters</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">params</span>
<span class="fu"><a href="../reference/initial_conditions.html">initial_conditions</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>S0<span class="op">=</span><span class="fl">0</span>, I0<span class="op">=</span><span class="fl">0</span>, R0<span class="op">=</span><span class="fl">0</span>, E0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co"># run model</span>
<span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">times</span><span class="op">)</span>
<span class="va">states</span> <span class="op">&lt;-</span> <span class="va">output</span><span class="op">$</span><span class="va">states</span>

<span class="co"># plot results</span>
<span class="va">states</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">compartment</span>, <span class="st">"E|I"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">time</span>, y<span class="op">=</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour<span class="op">=</span><span class="va">compartment</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"time (days)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"fraction of the population"</span><span class="op">)</span></code></pre></div>
<p><img src="SEmIRD_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="relating-n-to-an-erlang-distribution">Relating <span class="math inline">\(n\)</span> to an Erlang distribution<a class="anchor" aria-label="anchor" href="#relating-n-to-an-erlang-distribution"></a>
</h2>
<p>As described above, the waiting period implied by breaking a state into a number of substates, each with equal rate parameter, <span class="math inline">\(\kappa_s\)</span>, is an <span class="math inline">\(\text{Erlang}(n,\kappa_s)\)</span>. In our epidemiological model, this Erlang distribution is used to represent the latent period distribution, which represents how long it takes, on average, for an individual to transit from <span class="math inline">\(E\rightarrow I\)</span>.</p>
<p>We now demonstrate that this waiting period is represented by an Erlang distribution by simulating our model, each time with a different <span class="math inline">\(n\)</span>, assuming initially <span class="math inline">\(E_1=1\)</span>, and comparing each simulation to a corresponding Erlang probability density function. In doing so, we demonstrate that the linear chain trick works as desired (see <span class="citation">Hurtado and Kirosingh (2019)</span>). We select <span class="math inline">\(\kappa_s = n\kappa\)</span> so that the Erlang distribution representing the latent period distribution has a mean of <span class="math inline">\(1/\kappa\)</span>. For each different value of <span class="math inline">\(n\)</span>, we aggregate across all exposed compartments to yield the number of individuals remaining exposed at time <span class="math inline">\(t\)</span>: <span class="math inline">\(E(t)=\sum_{i=1}^{n} E_i(t)\)</span>. We then calculate the fraction of individuals who have transitioned out of the exposed compartments, via <span class="math inline">\(O(t) = 1 - E(t)\)</span> (note that <span class="math inline">\(O\)</span> contains individuals who are infectious or have previously been infectious). We then plot <span class="math inline">\(O(t)\)</span> for each model.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># function to run model with varying number of compartments but same mean</span>
<span class="va">run_varying_n</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">kappa</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SEmIRD-class.html">SEmIRD</a></span><span class="op">(</span><span class="op">)</span>
  
  <span class="co"># change parameters</span>
  <span class="va">kappa_s</span> <span class="op">&lt;-</span> <span class="va">kappa</span> <span class="op">*</span> <span class="va">n</span>
  <span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta<span class="op">=</span><span class="va">beta</span>, kappa<span class="op">=</span><span class="va">kappa_s</span>, gamma<span class="op">=</span><span class="va">gamma</span>, mu<span class="op">=</span><span class="va">mu</span><span class="op">)</span>
  <span class="fu"><a href="../reference/transmission_parameters.html">transmission_parameters</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">params</span>
  <span class="va">E_inits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="../reference/initial_conditions.html">initial_conditions</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>S0<span class="op">=</span><span class="fl">0</span>, I0<span class="op">=</span><span class="fl">0</span>, R0<span class="op">=</span><span class="fl">0</span>, E0<span class="op">=</span><span class="va">E_inits</span><span class="op">)</span>
  
  <span class="co"># run model</span>
  <span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">times</span><span class="op">)</span>
  <span class="va">states</span> <span class="op">&lt;-</span> <span class="va">output</span><span class="op">$</span><span class="va">states</span>
  <span class="va">states</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">compartment</span>, <span class="st">"E"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>value<span class="op">=</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>n<span class="op">=</span><span class="va">n</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># run simulations and store results</span>
<span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">100</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">ns</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">temp_df</span> <span class="op">&lt;-</span> <span class="fu">run_varying_n</span><span class="op">(</span><span class="va">ns</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">kappa</span><span class="op">)</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>
    <span class="va">big_df</span> <span class="op">&lt;-</span> <span class="va">temp_df</span>
  <span class="kw">else</span>
    <span class="va">big_df</span> <span class="op">&lt;-</span> <span class="va">big_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">temp_df</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># plot O(t)</span>
<span class="va">big_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">time</span>, y<span class="op">=</span><span class="va">value</span>, group<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour<span class="op">=</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_colour_viridis_c</a></span><span class="op">(</span>trans<span class="op">=</span><span class="st">"log"</span>,
                         breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"time (days)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"O(t)"</span><span class="op">)</span></code></pre></div>
<p><img src="SEmIRD_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<p>The plot above shows that, as <span class="math inline">\(n\)</span> increases, there tends be a narrower period when individuals transition to becoming infectious, which is centred around <span class="math inline">\(t=20\)</span> days. How does this relate to an Erlang distribution? To illustrate this, we transform the above into functions that behave as probability densities by finding the derivative at each time <span class="math inline">\(t\)</span> via a finite difference approximation. We then plot the corresponding Erlang probability densities alongside the ODE-derived ones. This plot shows the correspondence between the Erlang and ODE waiting times.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># use finite difference approximation to determine derivatives</span>
<span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">big_df</span><span class="op">$</span><span class="va">time</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="va">big_df</span> <span class="op">&lt;-</span> <span class="va">big_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>value<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span> <span class="op">/</span> <span class="va">dt</span><span class="op">)</span><span class="op">)</span>

<span class="co"># calculate Erlang pdfs</span>
<span class="va">erlang_density</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">kappa</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">times</span>, <span class="va">n</span>, <span class="va">kappa</span> <span class="op">*</span> <span class="va">n</span><span class="op">)</span>
<span class="op">}</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">ns</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">dens</span> <span class="op">&lt;-</span> <span class="fu">erlang_density</span><span class="op">(</span><span class="va">ns</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">kappa</span><span class="op">)</span>
  <span class="va">temp_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>time<span class="op">=</span><span class="va">times</span>,
                    value<span class="op">=</span><span class="va">dens</span>,
                    n<span class="op">=</span><span class="va">ns</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>
    <span class="va">other_df</span> <span class="op">&lt;-</span> <span class="va">temp_df</span>
  <span class="kw">else</span>
    <span class="va">other_df</span> <span class="op">&lt;-</span> <span class="va">other_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">temp_df</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">other_df</span> <span class="op">&lt;-</span> <span class="va">other_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"Erlang"</span><span class="op">)</span>

<span class="co"># plot</span>
<span class="va">big_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"ODE"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">other_df</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">time</span>, y<span class="op">=</span><span class="va">value</span>, group<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour<span class="op">=</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_colour_viridis_c</a></span><span class="op">(</span>trans<span class="op">=</span><span class="st">"log"</span>,
                         breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"time (days)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"density or O(t)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">type</span><span class="op">)</span></code></pre></div>
<p><img src="SEmIRD_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="comparing-covid-19-transmission-dynamics">Comparing COVID-19 transmission dynamics<a class="anchor" aria-label="anchor" href="#comparing-covid-19-transmission-dynamics"></a>
</h2>
<p>Assuming now <span class="math inline">\(\kappa=1/5.5\)</span>, which is more appropriate for COVID-19, we can compare the latent period distribution that was estimated by <span class="citation">Xin et al. (2021)</span> with the implied Erlang distribution of the SEmIRD model. Here, we choose <span class="math inline">\(n=5\)</span> exposed compartments since this choice provides a good visual fit to the empirical distribution.</p>
<p>We plot the probability density functions of the three delay periods. From this, it is clear that the Erlang distribution is a much closer approximation to the log-normal distribution than is the exponential. The SEmIRD model thus appears a more suitable distribution than the SEIRD model for describing COVID-19 transmission dynamics.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># values derived from Xi et al., Table S2 </span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">1.61</span>
<span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">0.44</span>

<span class="co"># equivalent decay for exponential model</span>
<span class="va">kappa</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">5.5</span>

<span class="co"># generate densities across rate of time</span>
<span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">0.01</span><span class="op">)</span>
<span class="va">lnorm_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">dlnorm</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">m</span>, <span class="va">sigma</span><span class="op">)</span>
<span class="va">exp_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">dexp</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">kappa</span><span class="op">)</span>
<span class="va">n_substates</span> <span class="op">&lt;-</span> <span class="fl">5</span>
<span class="va">erlang_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">n_substates</span>, <span class="va">kappa</span> <span class="op">*</span> <span class="va">n_substates</span><span class="op">)</span> <span class="co"># Erlang is gamma with integer rate</span>

<span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="va">t</span>, value<span class="op">=</span><span class="va">lnorm_vals</span>, model<span class="op">=</span><span class="st">"log-normal"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="va">t</span>, value<span class="op">=</span><span class="va">exp_vals</span>, model<span class="op">=</span><span class="st">"exponential"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="va">t</span>, value<span class="op">=</span><span class="va">erlang_vals</span>, model<span class="op">=</span><span class="st">"Erlang"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">t</span>, y<span class="op">=</span><span class="va">value</span>, colour<span class="op">=</span><span class="va">model</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span><span class="st">"Model"</span>, palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"density"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"time (days)"</span><span class="op">)</span></code></pre></div>
<p><img src="SEmIRD_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<p>But how do the epidemics produced by the SEIRD and SEmIRD models differ? We now simulate each model and plot the number of daily cases and deaths for each. From this plot, it is clear that the waves of cases or deaths produced for each model are similar, although the SEmIRD model wave is shifted so that it occurs later. This makes intuitive sense since the impact of the multiple exposed compartment substages is to induce a delay between exposure and infectiousness – effectively, resulting in a slightly delayed rise in cases and deaths.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># parameterise model</span>
<span class="va">kappa</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">5.5</span>

<span class="co"># parameterise SEIRD model</span>
<span class="va">model_seird</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SEIRD-class.html">SEIRD</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta<span class="op">=</span><span class="va">beta</span>, kappa<span class="op">=</span><span class="va">kappa</span>, gamma<span class="op">=</span><span class="va">gamma</span>, mu<span class="op">=</span><span class="va">mu</span><span class="op">)</span>
<span class="fu"><a href="../reference/transmission_parameters.html">transmission_parameters</a></span><span class="op">(</span><span class="va">model_seird</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">params</span>
<span class="fu"><a href="../reference/initial_conditions.html">initial_conditions</a></span><span class="op">(</span><span class="va">model_seird</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>S0<span class="op">=</span><span class="fl">0.999</span>, E0<span class="op">=</span><span class="fl">0</span>, I0<span class="op">=</span><span class="fl">0.001</span>, R0<span class="op">=</span><span class="fl">0</span><span class="op">)</span>

<span class="co"># parameterise SEmIRD model</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">5</span>
<span class="va">model_semird</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SEmIRD-class.html">SEmIRD</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta<span class="op">=</span><span class="va">beta</span>, kappa<span class="op">=</span><span class="va">kappa</span> <span class="op">*</span> <span class="va">n</span>, gamma<span class="op">=</span><span class="va">gamma</span>, mu<span class="op">=</span><span class="va">mu</span><span class="op">)</span>
<span class="fu"><a href="../reference/transmission_parameters.html">transmission_parameters</a></span><span class="op">(</span><span class="va">model_semird</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">params</span>
<span class="fu"><a href="../reference/initial_conditions.html">initial_conditions</a></span><span class="op">(</span><span class="va">model_semird</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>S0<span class="op">=</span><span class="fl">0.999</span>, I0<span class="op">=</span><span class="fl">0.001</span>, R0<span class="op">=</span><span class="fl">0</span>,
                                         E0<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co"># run both models and get cases and deaths</span>
<span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">150</span>, <span class="fl">1</span><span class="op">)</span>
<span class="va">output_seird</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span><span class="va">model_seird</span>, <span class="va">times</span><span class="op">)</span>
<span class="va">output_semird</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span><span class="va">model_semird</span>, <span class="va">times</span><span class="op">)</span>
<span class="va">changes_seird</span> <span class="op">&lt;-</span> <span class="va">output_seird</span><span class="op">$</span><span class="va">changes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>model<span class="op">=</span><span class="st">"SEIRD"</span><span class="op">)</span>
<span class="va">changes_semird</span> <span class="op">&lt;-</span> <span class="va">output_semird</span><span class="op">$</span><span class="va">changes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>model<span class="op">=</span><span class="st">"SEmIRD"</span><span class="op">)</span>

<span class="co"># compare cases and deaths</span>
<span class="va">changes_seird</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">changes_semird</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">time</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">time</span>, y<span class="op">=</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour<span class="op">=</span><span class="va">model</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"time (days)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"fraction of the population"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">compartment</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></code></pre></div>
<p><img src="SEmIRD_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<p>Including multiple substages is likely to be less important if variants of SARS-Cov-2 have shorter latent periods. This is likely the case for the Delta and Omicron variants which have been shown to have shorter incubation periods (near 4 days for Delta and approximately 3 days for Omicron versus more than 5 days for SARS-CoV-2; <span class="citation">Grant et al. (2021)</span>; <span class="citation">Ansen et al. (2021)</span>) – partly explaining their higher rate of spread.</p>
<p>The difference between the results of a single versus multiple exposed state model could, however, be even greater if, instead of an SEIRD-type model, we assumed a structure where there was a presymptomatic compartment of infectious individuals. In this instance, the nature of the delay period distribution governing the time spent in this compartment could result in different responses to some non-pharmaceutical interventions: for example, an intervention involving early detection and isolation of infected individuals.</p>
</div>
<div class="section level2 unnumbered">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references">
<div id="ref-cdcinvestigation2022">
<p>Ansen, Lauren, Bryan Tegomoh, Kate Lange, Kimberly Showalter, Jon Figliomeni, Baha Abdalhamid, Peter C. Iwen, Joseph Fauver, Bryan Buss, and Matthew Donahue. 2021. “Investigation of a Sars-Cov-2 B.1.1.529 (Omicron) Variant Cluster — Nebraska, November–December 2021.” <a href="%7Bhttps://www.cdc.gov/mmwr/volumes/70/wr/mm705152e3.htm%7D" class="external-link">{https://www.cdc.gov/mmwr/volumes/70/wr/mm705152e3.htm}</a>.</p>
</div>
<div id="ref-erban2007practical">
<p>Erban, Radek, Jonathan Chapman, and Philip Maini. 2007. “A Practical Guide to Stochastic Simulations of Reaction-Diffusion Processes.” <em>arXiv Preprint arXiv:0704.1908</em>.</p>
</div>
<div id="ref-grant2021impact">
<p>Grant, Rebecca, Tiffany Charmet, Laura Schaeffer, Simon Galmiche, Yoann Madec, Cassandre Von Platen, Olivia Chény, et al. 2021. “Impact of Sars-Cov-2 Delta Variant on Incubation, Transmission Settings and Vaccine Effectiveness: Results from a Nationwide Case-Control Study in France.” <em>The Lancet Regional Health-Europe</em>, 100278.</p>
</div>
<div id="ref-hurtado2019generalizations">
<p>Hurtado, Paul J, and Adam S Kirosingh. 2019. “Generalizations of the "Linear Chain Trick": Incorporating More Flexible Dwell Time Distributions into Mean Field Ode Models.” <em>Journal of Mathematical Biology</em> 79 (5): 1831–83.</p>
</div>
<div id="ref-xin2021estimating">
<p>Xin, Hualei, Yu Li, Peng Wu, Zhili Li, Eric HY Lau, Ying Qin, Liping Wang, Benjamin J Cowling, Tim Tsang, and Zhongjie Li. 2021. “Estimating the Latent Period of Coronavirus Disease 2019 (Covid-19).” <em>Clinical Infectious Diseases: An Official Publication of the Infectious Diseases Society of America</em>.</p>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by The Como-DTC Development Team.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
