<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="comomodels">
<title>Asymptomatic, mild and severe symptom compartment model • comomodels</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Asymptomatic, mild and severe symptom compartment model">
<meta property="og:description" content="comomodels">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">comomodels</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/SEIRD_age_structured.html">Age-structured model</a>
    <a class="dropdown-item" href="../articles/SEIaImIsRD.html">Asymptomatic, mild and severe symptom compartment model</a>
    <a class="dropdown-item" href="../articles/SEIRDNPIAge.html">NPIs: age-structured model</a>
    <a class="dropdown-item" href="../articles/SEIRD.html">SEIRD model</a>
    <a class="dropdown-item" href="../articles/SEIRDV.html">Vaccinations model</a>
    <a class="dropdown-item" href="../articles/SEIRDVAge.html">Vaccinations: age-structured model</a>
    <a class="dropdown-item" href="../articles/SEIRD_rural_urban.html">Urban and rural metapopulations model</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">
<script src="SEIaImIsRD_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Asymptomatic, mild and severe symptom compartment model</h1>
                        <h4 data-toc-skip class="author">Liangti Dai, David Seiferth, Solveig A. van der Vegt and Ben Lambert</h4>
            
      
      
      <div class="d-none name"><code>SEIaImIsRD.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This document introduces the SEIaImIsRD model. This model is an extension of the <a href="https://github.com/Como-DTC-Collaboration/como-models/blob/main/vignettes/SEIRD.Rmd" class="external-link">SEIRD model</a> where instead of having one population of infected individuals there are three, each with their own level of symptoms. In this model, populations of asymptomatic, mildly symptomatic and severely ill infectious individuals are included. The motivation for including these separate populations of infectious individuals is two-fold. First, asymptomatic individuals are much less likely to be detected and counted towards the overall case numbers than those with symptoms. Explicitly modelling this group may then lead to a more realistic depiction of the epidemic. Second, individuals with severe symptoms require treatment in hospitals and have a risk of death, whereas asymptomatic and mildly symptomatic individuals will likely recover without needing clinical care. Splitting the population of infectiousness individuals into these three groups thus allows us to estimate the burden of COVID-19 related clinical care on the healthcare system. Estimating this burden has been crucial throughout the COVID-19 pandemic, and estimates from modelling teams have, in part, motivated governments to impose a variety of interventions.</p>
<p>We start by introducing the equations of the model and explain how to calculate the basic reproduction number, <span class="math inline">\(R_0\)</span>. We then show how to simulate the SEIaImIsRD model using the <code>comomodels</code> package.</p>
</div>
<div class="section level2">
<h2 id="the-seiaimisrd-model">The SEIaImIsRD Model<a class="anchor" aria-label="anchor" href="#the-seiaimisrd-model"></a>
</h2>
<p>To build the SEIaImIsRD model with three compartments of infectious individuals, we start with the basic SEIRD model. As a reminder, this model consists of a group of susceptible individuals, <span class="math inline">\(S\)</span>, who are not infected but can be if they come in contact with an infectious individual; a group of exposed individuals, <span class="math inline">\(E\)</span>, who have been infected but are not infectious yet; a group of infectious individuals, <span class="math inline">\(I\)</span>, who can infect susceptibles; a group of recovered individuals, <span class="math inline">\(R\)</span>, who are immune to reinfection; and a group of individuals, <span class="math inline">\(D\)</span>, who have died due to COVID-19 infection.</p>
<p>To account for the varying severity of symptoms, we take the group of infectious individuals, <span class="math inline">\(I\)</span>, and split them into three groups: asymptomatic individuals, <span class="math inline">\(I_a\)</span>; mildly symptomatic individuals, <span class="math inline">\(I_m\)</span>; and severely ill individuals, <span class="math inline">\(I_s\)</span>. Thus, this model consists of seven ordinary differential equations (ODEs) to track all groups of individuals. The severity of symptoms can affect the probability that an infectious individual dies or infects someone else, for example, an asymptomatic individual will not cough and is thus less likely to transmit their infection.</p>
<p>The SEIaImIsRD model thus consists of the following ODEs:</p>
<p><span class="math display">\[\frac{\text{d}S}{\text{d}t} = -S (\beta_aI_a + \beta_mI_m + \beta_aI_s),\]</span> <span class="math display">\[\frac{\text{d}E}{\text{d}t} = S (\beta_aI_a + \beta_mI_m + \beta_sI_s) - \kappa E,\]</span> <span class="math display">\[\frac{dI_{a}}{dt} = \eta_a \kappa E - (\gamma_a + \mu_a)I_a,\]</span> <span class="math display">\[\frac{dI_{m}}{dt} = \eta_m \kappa E - (\gamma_m + \mu_m)I_m,\]</span> <span class="math display">\[\frac{dI_{s}}{dt} = \eta_s\kappa E - (\gamma_s + \mu_s)I_s,\]</span> <span class="math display">\[\frac{\text{d}R}{\text{d}t} =  \gamma_a  I_a + \gamma_m I_m + \gamma_sI_s,\]</span> <span class="math display">\[\frac{\text{d}D}{\text{d}t} =  \mu_a  I_a + \mu_m I_m + \mu_sI_s,\]</span> where, for <span class="math inline">\(i\in\{a, m, s\}\)</span>, <span class="math inline">\(\beta_i\)</span> are the rates at which an infected individual of symptom group <span class="math inline">\(i\)</span> infects susceptible individuals; <span class="math inline">\(\eta_i\)</span> are the fractions of exposed individuals moving into each of the different infected groups <span class="math inline">\(i\)</span> with <span class="math inline">\(\sum_i\eta_i=1\)</span>; <span class="math inline">\(\gamma_i\)</span> are the rates at which individuals of symptom group <span class="math inline">\(i\)</span> recover from the disease; and <span class="math inline">\(\mu_i\)</span>, the rates at which individuals of symptom group <span class="math inline">\(i\)</span> die of the disease. The rate of becoming infectious when infected, <span class="math inline">\(\kappa\)</span>, is the same for all groups of infectious individuals. All parameters are non-negative.</p>
<p>In addition to these seven main ODEs above, the model also keeps track of the total number of cases (<span class="math inline">\(C\)</span>) over time. Here, we define a case to be anyone infected with COVID-19, and thus the rate of appearance of new cases is given by:</p>
<p><span class="math display">\[\frac{\text{d}C}{\text{d}t} = S (\beta_aI_a + \beta_mI_m + \beta_aI_s).\]</span> The system is closed by specifying the initial conditions <span class="math inline">\(S(0) = S_\text{init},\ E(0) = E_\text{init},\ I_a(0) = I_{a,\text{init}},\ I_m(0) = I_{m,\text{init}},\ I_s(0) = I_{s,\text{init}},\ R(0) = R_\text{init},\ D(0) = D_\text{init}\)</span>. We assume <span class="math inline">\(C_\text{init} = 0\)</span> in the <code>comomodels</code> package to count only infections arising throughout a given epidemic.</p>
<p>With the ODEs and initial conditions specified, the system can be solved numerically to obtain the time traces <span class="math inline">\(S(t)\)</span>, <span class="math inline">\(E(t)\)</span>,<span class="math inline">\(I_a(t)\)</span>, <span class="math inline">\(I_m(t)\)</span>,<span class="math inline">\(I_s(t)\)</span>, <span class="math inline">\(R(t)\)</span>, <span class="math inline">\(D(t)\)</span>, and <span class="math inline">\(C(t)\)</span>. In the <code>comomodels</code> package, the populations are normalized so the total population is equal to 1, requiring that <span class="math inline">\(S(t)+E(t)+I_a(t)+I_m(t)+I_s(t)+R(t)+D(t) = 1\)</span> for all <span class="math inline">\(t\)</span>.</p>
</div>
<div class="section level2">
<h2 id="basic-reproduction-number">Basic reproduction number<a class="anchor" aria-label="anchor" href="#basic-reproduction-number"></a>
</h2>
<p>Before we numerically solve the SEIaImIsRD model, we derive an expression for the basic reproduction number, <span class="math inline">\(R_0\)</span>. The basic reproductive number is a widely used metric in epidemiological modelling and indicates whether a disease outbreak will occur. <span class="math inline">\(R_0\)</span> represents the average number of individuals that an infectious person will infect in a population where everyone is susceptible. If <span class="math inline">\(R_0&gt;1\)</span>, each individual typically infects more than one person, and the epidemic will likely grow. If <span class="math inline">\(R_0&lt;1\)</span>, the epidemic will likely subside. In this section, we compute the value of <span class="math inline">\(R_0\)</span> for the SEIaImIsRD model. For more mathematical detail on the method used, we refer the interested reader to <span class="citation">van den Driessche (2017)</span> and <span class="citation">Diekmann, Heesterbeek, and Roberts (2010)</span>.</p>
<p>We calculate the basic reproduction number (<span class="math inline">\(R_0\)</span>) using the next generation matrix approach. First, we select those populations in the model that contain infected individuals, i.e. those that are exposed, <span class="math inline">\(E\)</span>, or infectious, <span class="math inline">\(I_a\)</span>, <span class="math inline">\(I_m\)</span> and <span class="math inline">\(I_s\)</span>. We define <span class="math inline">\(x = [E, I_a, I_m, I_s]\)</span> and rewrite the ODEs of the variables in <span class="math inline">\(x\)</span> to be of the form: <span class="math display">\[\frac{\text{d}x_i}{\text{d}t} = \mathscr{F_i}(x) - \mathscr{V_i}(x),\]</span> where <span class="math inline">\(\mathscr{F_i}(x)\)</span> is the rate of appearance of new infections in compartment <span class="math inline">\(i\)</span>, and <span class="math inline">\(\mathscr{V_i}(x)\)</span> represents the rate of all other transitions out of that compartment. For example, if we take <span class="math inline">\(E\)</span>, then <span class="math inline">\(\mathscr{F}_E(x) = S (\beta_aI_a + \beta_mI_m + \beta_sI_s)\)</span> and <span class="math inline">\(\mathscr{V}_E(x) = \kappa E\)</span>. Considering <span class="math inline">\(I_i\)</span>, <span class="math inline">\(\mathscr{F}_i(x) = 0\)</span> because no new infections are epidemiologically ‘’born’’ directly into the infectious compartments, and <span class="math inline">\(\mathscr{V}_i(x) = (\gamma_i + \mu_i)I_i - \eta_i \kappa E\)</span>.</p>
<p>This then allows us to compute the matrices <span class="math inline">\(F\)</span> and <span class="math inline">\(V\)</span> for all variables in <span class="math inline">\(x\)</span>: <span class="math display">\[F=\frac{\partial \mathscr{F_i}}{\partial x_j}\Bigr|_{x^*}\hspace{5mm}\text{and }\hspace{5mm}V=\frac{\partial \mathscr{V_i}}{\partial x_j}\Bigr|_{x^*},\]</span> where <span class="math inline">\(x^*\)</span> represents the disease-free equilibrium for this model, where <span class="math inline">\(S=1\)</span>. For the SEIaImIsRD model, matrices <span class="math inline">\(F\)</span> and <span class="math inline">\(V\)</span> are: <span class="math display">\[
F = \left(\begin{array}{cc} 
0 &amp; \beta_{a} &amp; \beta_{m} &amp; \beta_{s}\\
0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0
\end{array}\right), 
\hspace{5mm}V = \left(\begin{array}{cc} 
\kappa &amp; 0 &amp; 0 &amp; 0\\
-\kappa \eta_a &amp; \gamma_a + \mu_a &amp; 0 &amp; 0\\
-\kappa \eta_m &amp; 0 &amp; \gamma_m + \mu_m &amp; 0\\
-\kappa \eta_s &amp; 0 &amp; 0 &amp; \gamma_s + \mu_s
\end{array}\right).
\]</span></p>
<p>The matrix <span class="math inline">\(K=FV^{-1}\)</span> is called the next generation matrix, and its <span class="math inline">\((i,j)\)</span>th entry is equal to the expected number of secondary infections in compartment <span class="math inline">\(i\)</span> produced by an infected individual introduced in compartment <span class="math inline">\(j\)</span>. For the SEIaImIsRD model, it is given by:</p>
<p><span class="math display">\[
K = \left(\begin{array}{cc} 
\sum_i\eta_i\phi_i &amp; \phi_a &amp; \phi_m &amp; \phi_s\\
0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0
\end{array}\right),\hspace{5mm} \text{where: }
\phi_i = \beta_{i} / (\gamma_i+\mu_i).
\]</span> The next generation matrix has an intuitive interpretation. Considering element <span class="math inline">\(K_{1,2}=\beta_{a} / (\gamma_a+\mu_a)\)</span>, this is the number of new infections that a single asymptomatic individual on average produces. This quantity is equal to the number of contacts per unit time, <span class="math inline">\(\beta\)</span>, times the average duration of infectiousness, <span class="math inline">\(1/ (\gamma_a+\mu_a)\)</span>. The same holds true for the other infectious compartments. The number of new infected individuals produced on average by a single infected individual is given by the <span class="math inline">\(K_{1,1}\)</span> element: this is given by a weighted average of the numbers produced by each infectious compartment where the weights are the proportions of infected individuals flowing into the various infectious compartments. All rows apart from the first are zero because no new infections are produced that fall directly into the infectious compartments.</p>
<p>The basic reproduction number for the SEIaImIsRD model is then defined as <span class="math display">\[R_0 = \rho(K^{-1}),\]</span> where <span class="math inline">\(\rho\)</span> denotes the spectral radius of a matrix (i.e. the largest absolute value of its eigenvalues). Due to the sparsity of this matrix, this is given by the <span class="math inline">\(K_{11}\)</span> element:</p>
<p><span class="math display">\[
R_0 = \sum_i\eta_i \phi_i.
\]</span></p>
</div>
<div class="section level2">
<h2 id="running-simulations">Running simulations<a class="anchor" aria-label="anchor" href="#running-simulations"></a>
</h2>
<p>In this section, we walk through an example of how to use the <code>SEIaImIsRD</code> class, the implementation of the SEIaImIsRD model in the <code>comomodels</code> package. In doing so, we parameterise the model using transmission parameters meant to represent the epidemiology of COVID-19.</p>
<p>To create a new <code>SEIaImIsRD</code> object, run:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SEIaImIsRD-class.html">SEIaImIsRD</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Next, we set the initial conditions. Because the populations are normalized, the populations must sum to one, or an error will be thrown.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">S</span> <span class="op">&lt;-</span> <span class="fl">0.999</span>
<span class="va">E</span> <span class="op">&lt;-</span> <span class="fl">0.001</span>
<span class="va">I_asymptomatic</span> <span class="op">&lt;-</span> <span class="fl">0</span>
<span class="va">I_mild</span> <span class="op">&lt;-</span> <span class="fl">0</span>
<span class="va">I_severe</span> <span class="op">&lt;-</span> <span class="fl">0</span>
<span class="va">R</span> <span class="op">&lt;-</span> <span class="fl">0</span>
<span class="va">D</span> <span class="op">&lt;-</span> <span class="fl">0</span>

<span class="fu"><a href="../reference/initial_conditions.html">initial_conditions</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>S <span class="op">=</span> <span class="va">S</span>, E <span class="op">=</span> <span class="va">E</span>, I_asymptomatic <span class="op">=</span> <span class="va">I_asymptomatic</span>,
                                  I_mild <span class="op">=</span> <span class="va">I_mild</span>, I_severe <span class="op">=</span> <span class="va">I_severe</span>, R <span class="op">=</span> <span class="va">R</span>, D <span class="op">=</span> <span class="va">D</span><span class="op">)</span></code></pre></div>
<p>We then set the parameter values. As with the other models, we set these parameters based on the COVID-19 pandemic. For a detailed derivation of the parameter values, see the <code>SEIRDAge</code> model vignette. We assume here that only individuals with severe symptoms die of the disease, i.e. <span class="math inline">\(\mu_a = \mu_m = 0\)</span>. We also assume that asymptomatic and mildly symptomatic individuals recover at approximately the same rate, but severely symptomatic individuals recover at half the rate. Approximately 35% of infected individuals will never develop symptoms, and thus belong to the asymptomatic group <span class="citation">(Sah et al. 2021)</span>. For the delta variant of the virus, it has been estimated that the hospitalisation rate is around 2% <span class="citation">(Twohig et al. 2021)</span>. The hospitalisation fatality rate is assumed to be 27% <span class="citation">(Gray et al. 2021)</span>. Here, for simplicity, we assume that all infectious individuals are equally infectious which may not be unrealistic if more severe cases are more likely to be isolated from ongoing contact (either due to self isolation or entering clinical care). We set <span class="math inline">\(\beta\)</span> so that <span class="math inline">\(R_0=2.4\)</span> – the same as the baseline reproduction number in report 9 <span class="citation">(Ferguson et al. 2020)</span>. To do so, we rearrange our expression above assuming <span class="math inline">\(\beta_a=\beta_m=\beta_s\)</span>:</p>
<p><span class="math display">\[
\beta = \frac{R_0}{\sum_i \eta_i / (\mu_i+\gamma_i)}.
\]</span></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_severe</span> <span class="op">&lt;-</span> <span class="fl">0.02</span>
<span class="va">p_asymp</span> <span class="op">&lt;-</span> <span class="fl">0.35</span>
<span class="va">p_mild</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">p_severe</span> <span class="op">-</span> <span class="va">p_asymp</span>
<span class="va">eta_symptom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mild <span class="op">=</span> <span class="va">p_mild</span>, severe<span class="op">=</span><span class="va">p_severe</span><span class="op">)</span>
<span class="va">zeta</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">2</span>
<span class="va">hfr</span> <span class="op">&lt;-</span> <span class="fl">0.27</span>
<span class="va">severe_vs_mild_rate</span> <span class="op">&lt;-</span> <span class="fl">0.5</span>
<span class="va">gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
  asymptomatic <span class="op">=</span> <span class="va">zeta</span>,
  mild <span class="op">=</span> <span class="va">zeta</span>,
  severe <span class="op">=</span> <span class="va">zeta</span> <span class="op">*</span> <span class="va">severe_vs_mild_rate</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">hfr</span><span class="op">)</span><span class="op">)</span>

<span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>asymptomatic <span class="op">=</span> <span class="fl">0</span>,
           mild <span class="op">=</span> <span class="fl">0</span>,
           severe <span class="op">=</span> <span class="va">zeta</span> <span class="op">*</span> <span class="va">severe_vs_mild_rate</span> <span class="op">*</span> <span class="va">hfr</span><span class="op">)</span>

<span class="co"># incubation period of 5.5 days assumed</span>
<span class="va">kappa</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">5.5</span>

<span class="co"># determine beta to hit target R0</span>
<span class="va">R0_target</span> <span class="op">&lt;-</span> <span class="fl">2.4</span>
<span class="va">p_symptoms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p_asymp</span>, <span class="va">p_mild</span>, <span class="va">p_severe</span><span class="op">)</span>
<span class="va">gamma_plus_mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">gamma</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span>
<span class="va">beta_overall</span> <span class="op">&lt;-</span> <span class="va">R0_target</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">p_symptoms</span> <span class="op">/</span> <span class="va">gamma_plus_mu</span><span class="op">)</span><span class="op">)</span>
<span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>asymptomatic <span class="op">=</span> <span class="va">beta_overall</span>,
             mild <span class="op">=</span> <span class="va">beta_overall</span>,
             severe <span class="op">=</span> <span class="va">beta_overall</span><span class="op">)</span>

<span class="co"># set parameters of model</span>
<span class="fu"><a href="../reference/transmission_parameters.html">transmission_parameters</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
  beta <span class="op">=</span> <span class="va">beta</span>, kappa <span class="op">=</span> <span class="va">kappa</span>, p_symptom <span class="op">=</span> <span class="va">eta_symptom</span>,
  gamma <span class="op">=</span> <span class="va">gamma</span>, mu <span class="op">=</span> <span class="va">mu</span><span class="op">)</span>

<span class="co"># check that target R0 hit</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"R0 = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="../reference/R0.html">R0</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "R0 = 2.4"</span></code></pre></div>
<p>Lastly, we set time span and time step for the simulation outputs. Here we choose to output results at a daily resolution. Note that the numerical solvers used to integrate the ODEs (by default, the LSODA method) typically compute the variables at many more time points for numerical accuracy. The results are returned only for the specified time points.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">250</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p>We can now simulate the model. We plot the evolution of <span class="math inline">\(S\)</span>, <span class="math inline">\(E\)</span>, <span class="math inline">\(I_a\)</span>, <span class="math inline">\(I_m\)</span>, <span class="math inline">\(I_s\)</span>, <span class="math inline">\(R\)</span>, and <span class="math inline">\(D\)</span> over time.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="co"># run the model</span>
<span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">t</span><span class="op">)</span>

<span class="co"># plot states over time</span>
<span class="va">states</span> <span class="op">&lt;-</span> <span class="va">output</span><span class="op">$</span><span class="va">states</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">states</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html" class="external-link">aes_string</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"time"</span>, y <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html" class="external-link">aes_string</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"compartment"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>, legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"time (days)"</span>, y <span class="op">=</span> <span class="st">"fraction of the population"</span><span class="op">)</span></code></pre></div>
<p><img src="SEIaImIsRD_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;"></p>
<p>We then focus on in on the infectious groups and see, as expected, that the bulk of infections are in the asymptomatic and mild groups.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">states</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">compartment</span>, <span class="st">"I_"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html" class="external-link">aes_string</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"time"</span>, y <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html" class="external-link">aes_string</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"compartment"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>, legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"time (days)"</span>, y <span class="op">=</span> <span class="st">"fraction of the population"</span><span class="op">)</span></code></pre></div>
<p><img src="SEIaImIsRD_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;"> We now assume a population size in the UK of 67.5m <span class="citation">(ONS 2021)</span> and plot the projected number of daily deaths using this model.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pop_size</span> <span class="op">&lt;-</span> <span class="fl">67.5e6</span>
<span class="va">output_deaths</span> <span class="op">&lt;-</span> <span class="va">output</span><span class="op">$</span><span class="va">changes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">compartment</span><span class="op">==</span><span class="st">"Deaths"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>value<span class="op">=</span><span class="va">pop_size</span> <span class="op">*</span> <span class="va">value</span><span class="op">)</span>

<span class="co"># plot number of deaths over time</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">output_deaths</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html" class="external-link">aes_string</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"time"</span>, y <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span> stat<span class="op">=</span><span class="st">"identity"</span>, position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"time (days)"</span>, y <span class="op">=</span> <span class="st">"deaths per day"</span><span class="op">)</span></code></pre></div>
<p><img src="SEIaImIsRD_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;"> The maximum number of daily deaths predicted by this model is approximately 10023, and overall, the number of deaths for such an unmitigated epidemic is predicted to be 320311– a value comparable to the figure of 510,000 deaths predicted in report 9 <span class="citation">(Ferguson et al. 2020)</span>, which was produced using a more complex agent-based spatial model of COVID-19 transmission dynamics.</p>
</div>
<div class="section level2">
<h2 id="sensitivity-analysis">Sensitivity analysis<a class="anchor" aria-label="anchor" href="#sensitivity-analysis"></a>
</h2>
<p>We now calculate the sensitivity of the overall number of deaths to two key parameters of the model via a local sensitivity analysis: the target <span class="math inline">\(R_0\)</span> value; <span class="math inline">\(\eta_s\)</span>, the probability of severe symptoms. All other parameters are fixed as in the simulations above. To do so, we create a convenience function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sensitivity_run</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">R0_target</span><span class="op">=</span><span class="fl">2.4</span>,
                            <span class="va">eta_s</span><span class="op">=</span><span class="fl">0.02</span><span class="op">)</span> <span class="op">{</span>
  
  <span class="co"># instantiate model</span>
  <span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SEIaImIsRD-class.html">SEIaImIsRD</a></span><span class="op">(</span><span class="op">)</span>
  
  <span class="co"># initial conditions</span>
  <span class="va">S</span> <span class="op">&lt;-</span> <span class="fl">0.999</span>
  <span class="va">E</span> <span class="op">&lt;-</span> <span class="fl">0.001</span>
  <span class="va">I_asymptomatic</span> <span class="op">&lt;-</span> <span class="fl">0</span>
  <span class="va">I_mild</span> <span class="op">&lt;-</span> <span class="fl">0</span>
  <span class="va">I_severe</span> <span class="op">&lt;-</span> <span class="fl">0</span>
  <span class="va">R</span> <span class="op">&lt;-</span> <span class="fl">0</span>
  <span class="va">D</span> <span class="op">&lt;-</span> <span class="fl">0</span>
  
  <span class="fu"><a href="../reference/initial_conditions.html">initial_conditions</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
    S <span class="op">=</span> <span class="va">S</span>,
    E <span class="op">=</span> <span class="va">E</span>,
    I_asymptomatic <span class="op">=</span> <span class="va">I_asymptomatic</span>,
    I_mild <span class="op">=</span> <span class="va">I_mild</span>,
    I_severe <span class="op">=</span> <span class="va">I_severe</span>,
    R <span class="op">=</span> <span class="va">R</span>,
    D <span class="op">=</span> <span class="va">D</span><span class="op">)</span>
  
  <span class="co"># transmission parameters</span>
  <span class="va">p_severe</span> <span class="op">&lt;-</span> <span class="va">eta_s</span>
  <span class="va">p_asymp</span> <span class="op">&lt;-</span> <span class="fl">0.35</span>
  <span class="va">p_mild</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">p_severe</span> <span class="op">-</span> <span class="va">p_asymp</span>
  <span class="va">eta_symptom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mild <span class="op">=</span> <span class="va">p_mild</span>, severe<span class="op">=</span><span class="va">p_severe</span><span class="op">)</span>
  <span class="va">zeta</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">2</span>
  <span class="va">severe_vs_mild_rate</span> <span class="op">&lt;-</span> <span class="fl">0.5</span>
  <span class="va">hfr</span> <span class="op">&lt;-</span> <span class="fl">0.27</span>
  <span class="va">gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
    asymptomatic <span class="op">=</span> <span class="va">zeta</span>,
    mild <span class="op">=</span> <span class="va">zeta</span>,
    severe <span class="op">=</span> <span class="va">zeta</span> <span class="op">*</span> <span class="va">severe_vs_mild_rate</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">hfr</span><span class="op">)</span><span class="op">)</span>
  
  <span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>asymptomatic <span class="op">=</span> <span class="fl">0</span>,
             mild <span class="op">=</span> <span class="fl">0</span>,
             severe <span class="op">=</span> <span class="va">zeta</span> <span class="op">*</span> <span class="va">severe_vs_mild_rate</span> <span class="op">*</span> <span class="va">hfr</span><span class="op">)</span>
  
  <span class="co"># incubation period of 5.5 days assumed</span>
  <span class="va">kappa</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">5.5</span>
  
  <span class="co"># determine beta to hit target R0</span>
  <span class="va">p_symptoms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p_asymp</span>, <span class="va">p_mild</span>, <span class="va">p_severe</span><span class="op">)</span>
  <span class="va">gamma_plus_mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">gamma</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span>
  <span class="va">beta_overall</span> <span class="op">&lt;-</span> <span class="va">R0_target</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">p_symptoms</span> <span class="op">/</span> <span class="va">gamma_plus_mu</span><span class="op">)</span><span class="op">)</span>
  <span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>asymptomatic <span class="op">=</span> <span class="va">beta_overall</span>,
               mild <span class="op">=</span> <span class="va">beta_overall</span>,
               severe <span class="op">=</span> <span class="va">beta_overall</span><span class="op">)</span>
  
  <span class="co"># set parameters of model</span>
  <span class="fu"><a href="../reference/transmission_parameters.html">transmission_parameters</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
    beta <span class="op">=</span> <span class="va">beta</span>, kappa <span class="op">=</span> <span class="va">kappa</span>, p_symptom <span class="op">=</span> <span class="va">eta_symptom</span>,
    gamma <span class="op">=</span> <span class="va">gamma</span>, mu <span class="op">=</span> <span class="va">mu</span><span class="op">)</span>

  <span class="co"># run model</span>
  <span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">250</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
  
  <span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">t</span><span class="op">)</span>
  <span class="va">pop_size</span> <span class="op">&lt;-</span> <span class="fl">67.5e6</span>
  <span class="va">output_deaths</span> <span class="op">&lt;-</span> <span class="va">output</span><span class="op">$</span><span class="va">changes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">compartment</span><span class="op">==</span><span class="st">"Deaths"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>value<span class="op">=</span><span class="va">pop_size</span> <span class="op">*</span> <span class="va">value</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">output_deaths</span><span class="op">$</span><span class="va">value</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>First, we explore the impact of <span class="math inline">\(R_0\)</span> (through <span class="math inline">\(\beta\)</span>) and in each case counting the overall number of deaths. We plot <span class="math inline">\(R_0\)</span> versus the number of deaths and obtain a sigmoidal curve, which shows the greatest sensitivity around <span class="math inline">\(1\leq R_0 \leq 1.5\)</span>. Nonetheless, if we assume an uncertainty of <span class="math inline">\(R_0=2.4\pm0.5\)</span>, we obtain a range from 279812 to 340188 deaths – a substantial variation highlighting the importance of knowing this quantity.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">R0_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">4</span>, <span class="fl">0.05</span><span class="op">)</span>
<span class="va">deaths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">R0_values</span><span class="op">)</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">deaths</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">deaths</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">sensitivity_run</span><span class="op">(</span>R0_target <span class="op">=</span> <span class="va">R0_values</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># plot</span>
<span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>R0<span class="op">=</span><span class="va">R0_values</span>, Deaths<span class="op">=</span><span class="va">deaths</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">R0</span>, y<span class="op">=</span><span class="va">Deaths</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">2.4</span>, colour<span class="op">=</span><span class="st">"orange"</span>,
             linetype<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="SEIaImIsRD_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;"> We next consider the sensitivity of total deaths to the probability that infection results in severe symptoms. Unsurprisingly, the number of deaths strongly depends on this parameter, and the relationship is approximately linear. Supposing uncertainty given by <span class="math inline">\(\eta_s=0.02\pm 0.01\)</span>, we obtain a range from 160155 to 480466 deaths. This variation shows the critical importance of knowing the fraction of cases likely to require hospitalisation. Initial analyses hint that the Omicron variant of SARS-CoV-2 may have a lower risk of hospitalisation than the Delta variant <span class="citation">(Ferguson et al. 2021)</span>. An issue is whether this lower rate of severe disease (if confirmed through multiple studies) will be overwhelmed by the explosive case counts reported from this variant around the world.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.005</span>, <span class="fl">0.06</span>, <span class="fl">0.001</span><span class="op">)</span>
<span class="va">deaths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">vals</span><span class="op">)</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">deaths</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">deaths</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">sensitivity_run</span><span class="op">(</span>eta_s<span class="op">=</span><span class="va">vals</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># plot</span>
<span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>prob_severe<span class="op">=</span><span class="va">vals</span>, Deaths<span class="op">=</span><span class="va">deaths</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">prob_severe</span>, y<span class="op">=</span><span class="va">Deaths</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0.02</span>, colour<span class="op">=</span><span class="st">"orange"</span>,
             linetype<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Probability of severe symptoms upon infection"</span><span class="op">)</span></code></pre></div>
<p><img src="SEIaImIsRD_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level2 unnumbered">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references">
<div id="ref-diekmann2010construction">
<p>Diekmann, Odo, JAP Heesterbeek, and Michael G Roberts. 2010. “The Construction of Next-Generation Matrices for Compartmental Epidemic Models.” <em>Journal of the Royal Society Interface</em> 7 (47): 873–85.</p>
</div>
<div id="ref-ferguson2021report50">
<p>Ferguson, Neil, Azra Ghani, Wes Hinsley, Erik Volz, and Imperial College COVID-19 response team. 2021. “Report 50: Hospitalisation Risk for Omicron Cases in England.” <a href="%7Bhttps://www.imperial.ac.uk/mrc-global-infectious-disease-analysis/covid-19/report-50-severity-omicron/%7D" class="external-link">{https://www.imperial.ac.uk/mrc-global-infectious-disease-analysis/covid-19/report-50-severity-omicron/}</a>.</p>
</div>
<div id="ref-ferguson2020report">
<p>Ferguson, Neil, Daniel Laydon, Gemma Nedjati Gilani, Natsuko Imai, Kylie Ainslie, Marc Baguelin, Sangeeta Bhatia, et al. 2020. “Report 9: Impact of Non-Pharmaceutical Interventions (Npis) to Reduce Covid19 Mortality and Healthcare Demand.”</p>
</div>
<div id="ref-gray2021variability">
<p>Gray, William K, Annakan V Navaratnam, Jamie Day, Pratusha Babu, Shona Mackinnon, Ini Adelaja, Sam Bartlett-Pestell, et al. 2021. “Variability in Covid-19 in-Hospital Mortality Rates Between National Health Service Trusts and Regions in England: A National Observational Study for the Getting It Right First Time Programme.” <em>EClinicalMedicine</em> 35: 100859.</p>
</div>
<div id="ref-ukpopulation2021">
<p>ONS. 2021. “Overview of the UK population: January 2021.” <a href="https://www.ons.gov.uk/peoplepopulationandcommunity/populationandmigration/populationestimates/articles/overviewoftheukpopulation/january2021" class="external-link">https://www.ons.gov.uk/peoplepopulationandcommunity/populationandmigration/populationestimates/articles/overviewoftheukpopulation/january2021</a>.</p>
</div>
<div id="ref-Sahe21">
<p>Sah, Pratha, Meagan C. Fitzpatrick, Charlotte F. Zimmer, Elaheh Abdollahi, Lyndon Juden-Kelly, Seyed M. Moghadas, Burton H. Singer, and Alison P. Galvani. 2021. “Asymptomatic Sars-Cov-2 Infection: A Systematic Review and Meta-Analysis.” <em>Proceedings of the National Academy of Sciences</em> 118 (34). <a href="https://doi.org/10.1073/pnas.2109229118" class="external-link">https://doi.org/10.1073/pnas.2109229118</a>.</p>
</div>
<div id="ref-twohig2021hospital">
<p>Twohig, Katherine A, Tommy Nyberg, Asad Zaidi, Simon Thelwall, Mary A Sinnathamby, Shirin Aliabadi, Shaun R Seaman, et al. 2021. “Hospital Admission and Emergency Care Attendance Risk for Sars-Cov-2 Delta (B. 1.617. 2) Compared with Alpha (B. 1.1. 7) Variants of Concern: A Cohort Study.” <em>The Lancet Infectious Diseases</em>.</p>
</div>
<div id="ref-vandenDriessche17">
<p>van den Driessche, Pauline. 2017. “Reproduction Numbers of Infectious Disease Models.” <em>Infectious Disease Modelling</em> 2 (3): 288–303. <a href="https://doi.org/10.1016/j.idm.2017.06.002" class="external-link">https://doi.org/10.1016/j.idm.2017.06.002</a>.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Sumali Bajaj, Fergus Cooper.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
